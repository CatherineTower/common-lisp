(in-package #:mfiano.graphics.image.test)

(plan nil)

(diag "~&XYZ -> XYY (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  (xyy
   (:a (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:b (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:c (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:d50 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:d55 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:d65 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:d75 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:d93 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:dci (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:e (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:f1 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:f2 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:f3 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:f4 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:f5 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:f6 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:f7 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:f8 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:f9 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:f10 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:f11 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:f12 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:led-b1 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:led-b2 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:led-b3 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:led-b4 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:led-b5 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:led-bh1 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:led-rgb1 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:led-v1 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
   (:led-v2 (0.0666666666666667d0 0.3333333333333333d0 0.5d0))))

(diag "~&XYZ -> Lab (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  (lab
   (:a (76.06926101415557d0 -171.92350361715827d0 -113.75969742631116d0))
   (:b (76.06926101415557d0 -164.0646912419932d0 -44.85717647673264d0))
   (:c (76.06926101415557d0 -163.2587478198661d0 -23.876862890932472d0))
   (:d50 (76.06926101415557d0 -161.93431912779107d0 -47.12993464958479d0))
   (:d55 (76.06926101415557d0 -161.32903352090023d0 -39.69359218424175d0))
   (:d65 (76.06926101415557d0 -160.80415330803353d0 -28.95290814060505d0))
   (:d75 (76.06926101415557d0 -160.74563661158305d0 -21.658929486356016d0))
   (:d93 (76.06926101415557d0 -161.01780634694077d0 -13.35021670186567d0))
   (:dci (76.06926101415557d0 -155.99147892249542d0 -37.3842896739216d0))
   (:e (76.06926101415557d0 -164.77082131141094d0 -34.357771724305984d0))
   (:f1 (76.06926101415557d0 -158.94637078036584d0 -32.054967913012455d0))
   (:f2 (76.06926101415557d0 -164.10533458440173d0 -61.58881702715016d0))
   (:f3 (76.06926101415557d0 -167.60390632852628d0 -84.77464249288695d0))
   (:f4 (76.06926101415557d0 -171.44413351214027d0 -105.97829177134955d0))
   (:f5 (76.06926101415557d0 -157.24664963514812d0 -35.18686289426054d0))
   (:f6 (76.06926101415557d0 -162.65102232132134d0 -69.96089815641892d0))
   (:f7 (76.06926101415557d0 -160.782877183007d0 -29.10275724476701d0))
   (:f8 (76.06926101415557d0 -161.92729016222683d0 -47.28461982841934d0))
   (:f9 (76.06926101415557d0 -165.0523396309187d0 -60.989416546922094d0))
   (:f10 (76.06926101415557d0 -161.73281814839623d0 -47.80501901245968d0))
   (:f11 (76.06926101415557d0 -165.4620594615077d0 -65.02559264975439d0))
   (:f12 (76.06926101415557d0 -170.68110547239496d0 -105.04314154142646d0))
   (:led-b1 (76.06926101415557d0 -173.2542100343455d0 -119.57332066215677d0))
   (:led-b2 (76.06926101415557d0 -171.06558587824586d0 -101.9231529863539d0))
   (:led-b3 (76.06926101415557d0 -165.45249952379615d0 -61.15600692681771d0))
   (:led-b4 (76.06926101415557d0 -162.9762067813502d0 -42.88941448648125d0))
   (:led-b5 (76.06926101415557d0 -161.87933327361466d0 -26.830040065876016d0))
   (:led-bh1 (76.06926101415557d0 -172.0515580507467d0 -112.93445518592502d0))
   (:led-rgb1 (76.06926101415557d0 -170.7998016115903d0 -132.13220398967616d0))
   (:led-v1 (76.06926101415557d0 -164.97457373448256d0 -173.61014305520362d0))
   (:led-v2 (76.06926101415557d0 -164.89364822426845d0 -64.47115728138651d0))))

(diag "~&XYZ -> LCHab (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  (lch-ab
   (:a (76.06926101415557d0 206.15275854211822d0 213.49212308653296d0))
   (:b (76.06926101415557d0 170.08641684095556d0 195.2916026420318d0))
   (:c (76.06926101415557d0 164.99552515514785d0 188.32061279504006d0))
   (:d50 (76.06926101415557d0 168.65335588554234d0 196.22729482454133d0))
   (:d55 (76.06926101415557d0 166.1404174705139d0 193.82256645577695d0))
   (:d65 (76.06926101415557d0 163.38986079592536d0 190.20679011115254d0))
   (:d75 (76.06926101415557d0 162.19823955936775d0 187.67383884816454d0))
   (:d93 (76.06926101415557d0 161.57030125232697d0 184.7396343289794d0))
   (:dci (76.06926101415557d0 160.4086238668327d0 193.47709407067245d0))
   (:e (76.06926101415557d0 168.3148241644105d0 191.7784589134084d0))
   (:f1 (76.06926101415557d0 162.14644538858627d0 191.40199440227752d0))
   (:f2 (76.06926101415557d0 175.28189644644488d0 200.5711393079714d0))
   (:f3 (76.06926101415557d0 187.82387874383332d0 206.83044604795307d0))
   (:f4 (76.06926101415557d0 201.55517667006688d0 211.7223082787655d0))
   (:f5 (76.06926101415557d0 161.13542174772905d0 192.61321156065213d0))
   (:f6 (76.06926101415557d0 177.0589798147041d0 203.2739353434785d0))
   (:f7 (76.06926101415557d0 163.39554484285594d0 190.25982622244794d0))
   (:f8 (76.06926101415557d0 168.6899006212291d0 196.27840792028482d0))
   (:f9 (76.06926101415557d0 175.9601765979283d0 200.28005848152299d0))
   (:f10 (76.06926101415557d0 168.65000536318948d0 196.4666361413839d0))
   (:f11 (76.06926101415557d0 177.78082242102295d0 201.45452776397835d0))
   (:f12 (76.06926101415557d0 200.41482317975127d0 211.60959982536195d0))
   (:led-b1 (76.06926101415557d0 210.51080805697381d0 214.6119292865149d0))
   (:led-b2 (76.06926101415557d0 199.1275063534599d0 210.78704860053483d0))
   (:led-b3 (76.06926101415557d0 176.39327306307558d0 200.28576368229355d0))
   (:led-b4 (76.06926101415557d0 168.52520835717903d0 194.74387157546784d0))
   (:led-b5 (76.06926101415557d0 164.08768872479897d0 189.41071024362776d0))
   (:led-bh1 (76.06926101415557d0 205.8055630828068d0 213.28085118601408d0))
   (:led-rgb1 (76.06926101415557d0 215.94326005163487d0 217.72584615647176d0))
   (:led-v1 (76.06926101415557d0 239.49340648653043d0 226.46100638318015d0))
   (:led-v2 (76.06926101415557d0 177.04927377967428d0 201.35481747487762d0))))

(diag "~&XYZ -> Luv (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  (luv
   (:a (76.06926101415557d0 -214.71916389660106d0 -86.43087632520403d0))
   (:b (76.06926101415557d0 -172.89773027019328d0 -47.73767101767365d0))
   (:c (76.06926101415557d0 -160.25395248044924d0 -23.730016104919535d0))
   (:d50 (76.06926101415557d0 -168.433664328575d0 -50.614015778569026d0))
   (:d55 (76.06926101415557d0 -163.75729165899213d0 -43.357554598283016d0))
   (:d65 (76.06926101415557d0 -157.22971934228326d0 -31.089998710875456d0))
   (:d75 (76.06926101415557d0 -152.9833672831231d0 -21.37442888537887d0))
   (:d93 (76.06926101415557d0 -148.2980171892419d0 -8.746414569130348d0))
   (:dci (76.06926101415557d0 -150.2441795482171d0 -42.4300735885938d0))
   (:e (76.06926101415557d0 -169.78565769536613d0 -36.382640934721316d0))
   (:f1 (76.06926101415557d0 -154.47745250542073d0 -35.4408231298608d0))
   (:f2 (76.06926101415557d0 -179.3399303167707d0 -62.10641223152191d0))
   (:f3 (76.06926101415557d0 -195.66856344012038d0 -75.56612290481544d0))
   (:f4 (76.06926101415557d0 -211.79679971924867d0 -83.72864506863688d0))
   (:f5 (76.06926101415557d0 -152.08128879497605d0 -39.599585626409635d0))
   (:f6 (76.06926101415557d0 -178.09888004200516d0 -68.55796320893285d0))
   (:f7 (76.06926101415557d0 -157.258980505736d0 -31.284534592092207d0))
   (:f8 (76.06926101415557d0 -168.47858244834694d0 -50.76216854283636d0))
   (:f9 (76.06926101415557d0 -181.66803580585014d0 -61.318244479384624d0))
   (:f10 (76.06926101415557d0 -168.2011627188197d0 -51.313149534418486d0))
   (:f11 (76.06926101415557d0 -184.10788088581057d0 -64.1474502373511d0))
   (:f12 (76.06926101415557d0 -209.25267004161205d0 -83.68626069118993d0))
   (:led-b1 (76.06926101415557d0 -219.95439402621244d0 -87.81722504225219d0))
   (:led-b2 (76.06926101415557d0 -209.82533031604382d0 -82.24701435191548d0))
   (:led-b3 (76.06926101415557d0 -182.80447472880934d0 -61.302056398914814d0))
   (:led-b4 (76.06926101415557d0 -169.26822345883622d0 -46.142131125961704d0))
   (:led-b5 (76.06926101415557d0 -158.6305099039931d0 -28.061173829352807d0))
   (:led-bh1 (76.06926101415557d0 -214.98022747320329d0 -86.07967886375341d0))
   (:led-rgb1 (76.06926101415557d0 -213.9929459678447d0 -92.7305136585419d0))
   (:led-v1 (76.06926101415557d0 -200.64325443452378d0 -104.39685664781143d0))
   (:led-v2 (76.06926101415557d0 -182.38989442126388d0 -63.953826184901324d0))))

(diag "~&XYZ -> LCHuv (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  (lch-uv
   (:a (76.06926101415557d0 231.4619098832422d0 201.9262578395828d0))
   (:b (76.06926101415557d0 179.36697122596496d0 195.43501604301437d0))
   (:c (76.06926101415557d0 162.00136712369383d0 188.42301208186032d0))
   (:d50 (76.06926101415557d0 175.87403979093762d0 196.7254293750434d0))
   (:d55 (76.06926101415557d0 169.39990588023156d0 194.8297614795068d0))
   (:d65 (76.06926101415557d0 160.2740548694498d0 191.1851578785593d0))
   (:d75 (76.06926101415557d0 154.46933959675965d0 187.95372578371968d0))
   (:d93 (76.06926101415557d0 148.5557190756242d0 183.37531681166112d0))
   (:dci (76.06926101415557d0 156.1205451977746d0 195.77007430681883d0))
   (:e (76.06926101415557d0 173.64004757092442d0 192.09475707701208d0))
   (:f1 (76.06926101415557d0 158.49080502252045d0 192.9214121094805d0))
   (:f2 (76.06926101415557d0 189.7894018281735d0 199.10125329437048d0))
   (:f3 (76.06926101415557d0 209.75324943749044d0 201.11628655174076d0))
   (:f4 (76.06926101415557d0 227.74628509889092d0 201.57014362394642d0))
   (:f5 (76.06926101415557d0 157.15230059825487d0 194.59484082687828d0))
   (:f6 (76.06926101415557d0 190.83868945152065d0 201.05387416530917d0))
   (:f7 (76.06926101415557d0 160.3406032617667d0 191.25132425342264d0))
   (:f8 (76.06926101415557d0 175.95974113124788d0 196.7674206281879d0))
   (:f9 (76.06926101415557d0 191.73732641191498d0 198.65103437834432d0))
   (:f10 (76.06926101415557d0 175.85411696944843d0 196.96538166643379d0))
   (:f11 (76.06926101415557d0 194.96309183078026d0 199.20952018528575d0))
   (:f12 (76.06926101415557d0 225.36652401813708d0 201.79791421535145d0))
   (:led-b1 (76.06926101415557d0 236.83707578324783d0 201.76445255915044d0))
   (:led-b2 (76.06926101415557d0 225.36912080416226d0 201.4041107222658d0))
   (:led-b3 (76.06926101415557d0 192.8092790806802d0 198.53847641347832d0))
   (:led-b4 (76.06926101415557d0 175.44465719353198d0 195.24820933210407d0))
   (:led-b5 (76.06926101415557d0 161.0933522808499d0 190.03164116006852d0))
   (:led-bh1 (76.06926101415557d0 231.57333464308266d0 201.82153046427234d0))
   (:led-rgb1 (76.06926101415557d0 233.22077327582534d0 203.4287462490517d0))
   (:led-v1 (76.06926101415557d0 226.17784866785857d0 207.48844809682643d0))
   (:led-v2 (76.06926101415557d0 193.27743135371068d0 199.3228844723805d0))))

(diag "~&XYZ -> RGB/Adobe RGB (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  ((rgb :adobe-rgb)
   (:a (-0.7697151200873475d0 0.9889606408043885d0 1.5931540563888826d0))
   (:b (-0.6790439204036712d0 0.9575641661998884d0 1.0464855782382698d0))
   (:c (-0.6570750966297292d0 0.9519722995623408d0 0.8950850108011009d0))
   (:d50 (-0.6713382892495502d0 0.9485299657923821d0 1.0641151328471863d0))
   (:d55 (-0.6625231523293378d0 0.9458272570433879d0 1.009320823421099d0))
   (:d65 (-0.6506476844589087d0 0.9427701227757195d0 0.9317203934060017d0))
   (:d75 (-0.6432349835938731d0 0.941387891326295d0 0.8800510133007129d0))
   (:d93 (-0.6353885833762584d0 0.9405429466436521d0 0.8221968400312993d0))
   (:dci (-0.6378994392636793d0 0.9257388139838841d0 0.9938878478146349d0))
   (:e (-0.6736754584571568d0 0.9599892636483003d0 0.9694763728683282d0))
   (:f1 (-0.6453839695140408d0 0.9359909431827202d0 0.9544452518263347d0))
   (:f2 (-0.6922772607340894d0 0.9574510159428447d0 1.172899810404361d0))
   (:f3 (-0.7258717329421643d0 0.9714556418368056d0 1.3543430359715145d0))
   (:f4 (-0.7609500422675389d0 0.9881055567926227d0 1.5270095245580875d0))
   (:f5 (-0.6410637369792598d0 0.9300296956287238d0 0.9775435261034179d0))
   (:f6 (-0.6924057325199942d0 0.9503571575095912d0 1.2388744548768906d0))
   (:f7 (-0.6506930131156837d0 0.9427055821453488d0 0.9327968199816329d0))
   (:f8 (-0.6714327873103874d0 0.9485022772972872d0 1.0652716215887323d0))
   (:f9 (-0.6960803139812941d0 0.9617723098399251d0 1.1678441619547246d0))
   (:f10 (-0.671004212280594d0 0.9477040661438767d0 1.069225022403034d0))
   (:f11 (-0.7010109211266065d0 0.9634009763163263d0 1.1988313226264253d0))
   (:f12 (-0.7564483954960423d0 0.9839264209844445d0 1.5199099529390927d0))
   (:led-b1 (-0.7813010040709077d0 0.9954998118050501d0 1.6419314044653646d0))
   (:led-b2 (-0.7558271155018588d0 0.9868454153048688d0 1.4931217713670897d0))
   (:led-b3 (-0.6980332602828949d0 0.9636112354370386d0 1.1689375295812992d0))
   (:led-b4 (-0.6725127507164953d0 0.9527930875524374d0 1.0323070810263033d0))
   (:led-b5 (-0.6535054614321958d0 0.9467670339780168d0 0.9163270076610582d0))
   (:led-bh1 (-0.7696645243352812d0 0.989949138910795d0 1.5858587160734536d0))
   (:led-rgb1 (-0.7805282639441904d0 0.9765448062861962d0 1.7577907342047057d0))
   (:led-v1 (-0.8022701758249658d0 0.9245186244387394d0 2.1754852094222716d0))
   (:led-v2 (-0.6980137238110043d0 0.9608157208904506d0 1.1948127681449856d0))))

(diag "~&XYZ -> RGB/Adobe Wide Gamut RGB (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  ((rgb :adobe-wide-gamut-rgb)
   (:a (-0.5731337746920511d0 0.9472045911674983d0 1.5666167224149437d0))
   (:b (-0.4786657054150297d0 0.8741718777086016d0 1.0334361388533033d0))
   (:c (-0.4539241207229565d0 0.8601290043387663d0 0.8865097968250844d0))
   (:d50 (-0.4723003475856213d0 0.8682758364007916d0 1.0504541985330904d0))
   (:d55 (-0.4625855248693056d0 0.8623425315324531d0 0.9971859037619109d0))
   (:d65 (-0.4491297605310007d0 0.8549612262210345d0 0.9218617258813389d0))
   (:d75 (-0.4404252944702213d0 0.8508497296718924d0 0.87180271252545d0))
   (:d93 (-0.4308573815297077d0 0.8470959960918827d0 0.8158661962642484d0))
   (:dci (-0.4391436808315524d0 0.8455063515761495d0 0.9819473537849065d0))
   (:e (-0.4714769965672789d0 0.8709942567984879d0 0.9587101446485923d0))
   (:f1 (-0.444932322117221d0 0.8510022708447975d0 0.9438022407021123d0))
   (:f2 (-0.494270230475d0 0.8835103429541425d0 1.1563892241876148d0))
   (:f3 (-0.5288590840057652d0 0.9100004481580249d0 1.3333556956774413d0))
   (:f4 (-0.5636817108689054d0 0.9396162420336048d0 1.502015792635498d0))
   (:f5 (-0.4416094292211911d0 0.8477899792559404d0 0.966134962013209d0))
   (:f6 (-0.4964845356132844d0 0.8834109220775762d0 1.2205700085793645d0))
   (:f7 (-0.4492071982864836d0 0.8549753618942735d0 0.9229041070265429d0))
   (:f8 (-0.4724215404650884d0 0.8683367907810934d0 1.0515779960100113d0))
   (:f9 (-0.4974279814249203d0 0.8865006601788068d0 1.1515174040093807d0))
   (:f10 (-0.4721586936742577d0 0.867991901303143d0 1.055411171914353d0))
   (:f11 (-0.5026758863280126d0 0.8902567749444278d0 1.1817062876171396d0))
   (:f12 (-0.5597783762203887d0 0.9357008365630946d0 1.4950458149602206d0))
   (:led-b1 (-0.5841905065060369d0 0.957430736572201d0 1.6143198843967799d0))
   (:led-b2 (-0.558327735830178d0 0.9352106471942911d0 1.4689204183009477d0))
   (:led-b3 (-0.4991595646558183d0 0.8880318640491285d0 1.1526031635232152d0))
   (:led-b4 (-0.4723703031212358d0 0.8694135079340763d0 1.0196002459296276d0))
   (:led-b5 (-0.4512963275253952d0 0.8572141416484708d0 0.9070029039922947d0))
   (:led-bh1 (-0.5728266689973531d0 0.9471738755539205d0 1.5595000621497312d0))
   (:led-rgb1 (-0.5880165735939044d0 0.9565678587865982d0 1.7273856977147477d0))
   (:led-v1 (-0.6228647949765374d0 0.9762998802584655d0 2.1356283582041993d0))
   (:led-v2 (-0.4999540676808145d0 0.8879055685595647d0 1.1777636858286553d0))))

(diag "~&XYZ -> RGB/Apple RGB (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  ((rgb :apple-rgb)
   (:a (-1.0293826209100296d0 0.9970452363419846d0 1.8160170985414579d0))
   (:b (-0.9064494408242996d0 0.9715626302048309d0 1.0660637248739986d0))
   (:c (-0.8784901654805399d0 0.9672459982185322d0 0.8689598379090018d0))
   (:d50 (-0.895044206431973d0 0.9596984422121198d0 1.0901116330727811d0))
   (:d55 (-0.8836728304211021d0 0.9573756993860829d0 1.0181180599690907d0))
   (:d65 (-0.8686671583704468d0 0.9549385706716539d0 0.9171892893177662d0))
   (:d75 (-0.8595505909227675d0 0.9540588141347696d0 0.8506280976923748d0))
   (:d93 (-0.8501855719329822d0 0.9538783850265785d0 0.776668900784735d0))
   (:dci (-0.8496481406112414d0 0.9321937752430274d0 0.9995949356941043d0))
   (:e (-0.9003766733271247d0 0.9761424165890683d0 0.9647357920730901d0))
   (:f1 (-0.8608421796017298d0 0.9459318521821795d0 0.9472961368765125d0))
   (:f2 (-0.9229470452749247d0 0.9686341053449775d0 1.2346716813597745d0))
   (:f3 (-0.9685691368718333d0 0.9818660362008053d0 1.481370595857949d0))
   (:f4 (-1.0175999142634269d0 0.9981172136724414d0 1.7220184559232319d0))
   (:f5 (-0.8543604843972339d0 0.9379447782158767d0 0.9778908322168612d0))
   (:f6 (-0.9217237643030561d0 0.9579582205763625d0 1.3244381922583592d0))
   (:f7 (-0.8687065034882662d0 0.9548377128270246d0 0.9185903721650601d0))
   (:f8 (-0.895154901146162d0 0.9596389002766412d0 1.0916448478060774d0))
   (:f9 (-0.928599892013155d0 0.9742692732094779d0 1.2275461463826185d0))
   (:f10 (-0.8944609642205844d0 0.958540082707177d0 1.0969443599017714d0))
   (:f11 (-0.935158742386231d0 0.9756117109480001d0 1.2692271627796772d0))
   (:f12 (-1.010876299360067d0 0.9929476160135449d0 1.7122162675966892d0))
   (:led-b1 (-1.0460390790723981d0 1.0038441098227373d0 1.8855098346061632d0))
   (:led-b2 (-1.0106002993087022d0 0.9975620687465734d0 1.6742161522399985d0))
   (:led-b3 (-0.9314321252661649d0 0.976592121799724d0 1.2288809142925614d0))
   (:led-b4 (-0.8973862995016851d0 0.9657761485730537d0 1.0477564919766476d0))
   (:led-b5 (-0.8730044299155356d0 0.9602787629618595d0 0.8968896528313074d0))
   (:led-bh1 (-1.0294975523472178d0 0.9985702761580595d0 1.8055499398474446d0))
   (:led-rgb1 (-1.0415762465374527d0 0.9749882439163173d0 2.054058460939459d0))
   (:led-v1 (-1.0622306666485226d0 0.8879431724029734d0 2.6781414862341166d0))
   (:led-v2 (-0.9308531906135307d0 0.9724059411157598d0 1.263983112982049d0))))

(diag "~&XYZ -> RGB/Best RGB (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  ((rgb :best-rgb)
   (:a (-0.6235061273876644d0 0.9132118692851159d0 1.5419897935869218d0))
   (:b (-0.5826153186750408d0 0.8674294652220311d0 1.0260620601650714d0))
   (:c (-0.5712129185145218d0 0.8591485305701023d0 0.8852338444221978d0))
   (:d50 (-0.5732582775939562d0 0.8604342601838557d0 1.0421155729045235d0))
   (:d55 (-0.5685591223618068d0 0.8567298317507505d0 0.9908805757443617d0))
   (:d65 (-0.5621652134366604d0 0.8523290854130737d0 0.9186389732629686d0))
   (:d75 (-0.5581599284273805d0 0.8500862626566459d0 0.8707981755777681d0))
   (:d93 (-0.553877170140846d0 0.8483110013760061d0 0.8175418594189203d0))
   (:dci (-0.5443288620334481d0 0.839814809729467d0 0.9755872221202216d0))
   (:e (-0.5829326261753534d0 0.8674757718794868d0 0.9545119205269107d0))
   (:f1 (-0.5551183738152228d0 0.8472645589578857d0 0.9393830922387384d0))
   (:f2 (-0.5855840197590413d0 0.8710583513512126d0 1.144355545346201d0))
   (:f3 (-0.603261841299221d0 0.8889380661847975d0 1.315625767672392d0))
   (:f4 (-0.621839028184125d0 0.9096094236954749d0 1.4793330978337536d0))
   (:f5 (-0.5489037467510256d0 0.8429226277186884d0 0.960568714076871d0))
   (:f6 (-0.5794953728619726d0 0.8673869984618018d0 1.206076140924522d0))
   (:f7 (-0.5621349773187959d0 0.8523000568293856d0 0.9196330913019091d0))
   (:f8 (-0.5732606384698743d0 0.8604436781843473d0 1.0431947477853398d0))
   (:f9 (-0.5899982530946599d0 0.8744743812479453d0 1.1397865686986877d0))
   (:f10 (-0.572490468827518d0 0.8598950683973923d0 1.0468536460895967d0))
   (:f11 (-0.5923287916479238d0 0.8768150507626454d0 1.1689360815415493d0))
   (:f12 (-0.6177947367778108d0 0.9058699235824212d0 1.4724838843114239d0))
   (:led-b1 (-0.6301837194423607d0 0.920792353625666d0 1.5884065117325834d0))
   (:led-b2 (-0.6201967580792507d0 0.9071400808794616d0 1.4472329038573564d0))
   (:led-b3 (-0.5919303707321567d0 0.8760322214465622d0 1.1408869541848263d0))
   (:led-b4 (-0.5770275880275726d0 0.863094263206437d0 1.0126214323122675d0))
   (:led-b5 (-0.5661558808183308d0 0.8552909666419758d0 0.9045907254105723d0))
   (:led-bh1 (-0.6243347887147255d0 0.9136960321915121d0 1.53510841473918d0))
   (:led-rgb1 (-0.6140504870661747d0 0.910970649555578d0 1.697815212897065d0))
   (:led-v1 (-0.5704625873970658d0 0.8943706094995684d0 2.094196811890262d0))
   (:led-v2 (-0.5895701081899456d0 0.8745450166543521d0 1.1650600967167977d0))))

(diag "~&XYZ -> RGB/Beta RGB (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  ((rgb :beta-rgb)
   (:a (-0.5815177137348532d0 0.9667290304846742d0 1.5594019414410598d0))
   (:b (-0.5500170831045643d0 0.9196814774564992d0 1.029486249209288d0))
   (:c (-0.5404172617119495d0 0.9110025857696278d0 0.8835608239600186d0))
   (:d50 (-0.5404036351746568d0 0.9119146828771577d0 1.0463824545685765d0))
   (:d55 (-0.5364235335418134d0 0.9080299715362711d0 0.9934645614045104d0))
   (:d65 (-0.5309589698393967d0 0.9033952197840927d0 0.9186524454801451d0))
   (:d75 (-0.5275095278488973d0 0.901018423101364d0 0.8689475758061647d0))
   (:d93 (-0.5237824888825706d0 0.8991138432151157d0 0.8134238568050595d0))
   (:dci (-0.5122660985195301d0 0.8893709491041099d0 0.978309557953973d0))
   (:e (-0.5512984380145708d0 0.9199903868988205d0 0.9552656747406622d0))
   (:f1 (-0.5236210325785745d0 0.8977379249138883d0 0.9404338247119949d0))
   (:f2 (-0.5511713224055068d0 0.9231271182873407d0 1.1516445320510869d0))
   (:f3 (-0.5658674464847174d0 0.941757242445798d0 1.3275264393626636d0))
   (:f4 (-0.5812302208651096d0 0.9632629470899311d0 1.4951849334142644d0))
   (:f5 (-0.517086008556167d0 0.8928657052415512d0 0.9626080413567525d0))
   (:f6 (-0.5439786831354205d0 0.9187540325417769d0 1.2154152758558445d0))
   (:f7 (-0.5309163264704377d0 0.9033605777411376d0 0.9196874771911463d0))
   (:f8 (-0.5403899813129969d0 0.9119205403479621d0 1.0474988548940631d0))
   (:f9 (-0.5556770411841548d0 0.9269040164180634d0 1.1468081431478476d0))
   (:f10 (-0.5395622783287679d0 0.91130055518949d0 1.0513060979883728d0))
   (:f11 (-0.5575321441033138d0 0.9293222672941821d0 1.1768078994886861d0))
   (:f12 (-0.5772956834031306d0 0.9592208147365635d0 1.4882526904402447d0))
   (:led-b1 (-0.587201337090969d0 0.9746550935100274d0 1.606828321192019d0))
   (:led-b2 (-0.5802621936365536d0 0.9607952441424263d0 1.4622864563035027d0))
   (:led-b3 (-0.5575969762013083d0 0.9286091852638363d0 1.1478889811776696d0))
   (:led-b4 (-0.5446105027185212d0 0.9149633916124019d0 1.0157367374142052d0))
   (:led-b5 (-0.5351295933497657d0 0.9067018409235874d0 0.9039022997462457d0))
   (:led-bh1 (-0.5825127733838218d0 0.9673122473424455d0 1.5523284463200169d0))
   (:led-rgb1 (-0.5680639678112656d0 0.9629754411090968d0 1.7192126566428487d0))
   (:led-v1 (-0.5098336565782224d0 0.9405850584423707d0 2.125053620150444d0))
   (:led-v2 (-0.5548280781620895d0 0.9268499774036375d0 1.17288742812562d0))))

(diag "~&XYZ -> RGB/Bruce RGB (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  ((rgb :bruce-rgb)
   (:a (-0.9638435815584252d0 0.9889645393205956d0 1.5918492288758823d0))
   (:b (-0.8717506595761926d0 0.9575789114910005d0 1.0462819029492187d0))
   (:c (-0.8502790720822232d0 0.9519889387169559d0 0.8952509152530028d0))
   (:d50 (-0.8623416147987701d0 0.9485477650087506d0 1.063852423378851d0))
   (:d55 (-0.8535904310063275d0 0.9458459639618152d0 1.0091822842347509d0))
   (:d65 (-0.8419941314507436d0 0.9427898531247525d0 0.9317684152231414d0))
   (:d75 (-0.834921771366557d0 0.941408083247533d0 0.8802323445870849d0))
   (:d93 (-0.8276274550139177d0 0.9405634203647522d0 0.8225386142220986d0))
   (:dci (-0.8258886608285093d0 0.9257641811339834d0 0.9937453891671387d0))
   (:e (-0.8674889353650704d0 0.9600031839952312d0 0.9694661774457546d0))
   (:f1 (-0.8354119810862585d0 0.9360129304128769d0 0.9544206956695892d0))
   (:f2 (-0.883860268743618d0 0.9574657996710288d0 1.1724084739919094d0))
   (:f3 (-0.9184995678510668d0 0.9714656323126982d0 1.353490616768251d0))
   (:f4 (-0.9553934972132383d0 0.9881097554599849d0 1.5258333730174145d0))
   (:f5 (-0.8299032471910563d0 0.9300536530407206d0 0.9774493324587987d0))
   (:f6 (-0.8821587493133695d0 0.9503743415160885d0 1.2382294608010418d0))
   (:f7 (-0.842017896535818d0 0.942725334062625d0 0.932841927708117d0))
   (:f8 (-0.8624206973044608d0 0.9485200858266829d0 1.065006176266263d0))
   (:f9 (-0.8884726006176605d0 0.9617856222612995d0 1.1673714712191476d0))
   (:f10 (-0.8618198820390288d0 0.947722143028245d0 1.0689488939161989d0))
   (:f11 (-0.8934336668975695d0 0.963413732422036d0 1.1982936570522331d0))
   (:f12 (-0.95014957299712d0 0.9839320828264803d0 1.518742328183247d0))
   (:led-b1 (-0.976340947266366d0 0.9955014062832889d0 1.640539802950529d0))
   (:led-b2 (-0.9502798566882952d0 0.9868500558275857d0 1.4920111086985237d0))
   (:led-b3 (-0.8907434975609024d0 0.9636239196517129d0 1.1684656547095498d0))
   (:led-b4 (-0.8645330784551069d0 0.95280944944961d0 1.0321275683159241d0))
   (:led-b5 (-0.8456524812056363d0 0.9467854255838057d0 0.9164241344412133d0))
   (:led-bh1 (-0.9640344375559394d0 0.9899526901178418d0 1.5845693643837875d0))
   (:led-rgb1 (-0.9711098032826098d0 0.9765530371250183d0 1.7561554468606642d0))
   (:led-v1 (-0.9801842367523792d0 0.9245443911853561d0 2.173029077781267d0))
   (:led-v2 (-0.8900080101346411d0 0.9608293596046998d0 1.1942794261882945d0))))

(diag "~&XYZ -> RGB/BT.2020 (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  ((rgb :bt2020)
   (:a (-1.313876023387289d0 0.9217858414456268d0 1.5992426528754269d0))
   (:b (-1.1437203021797735d0 0.8850392528792085d0 1.0299314588704813d0))
   (:c (-1.095511071077642d0 0.8786160571220188d0 0.8731896371698361d0))
   (:d50 (-1.1000815373778399d0 0.8763841101848722d0 1.047971240634359d0))
   (:d55 (-1.0805105528471493d0 0.8733435263613762d0 0.9911019265588923d0))
   (:d65 (-1.053907202982205d0 0.8698763779190515d0 0.9107281678193326d0))
   (:d75 (-1.0372306057909777d0 0.8682683685665477d0 0.8573551950584877d0))
   (:d93 (-1.019307553480602d0 0.8672227525820486d0 0.7977728002318213d0))
   (:dci (-0.9740591411389024d0 0.8537727555798953d0 0.9745768555863821d0))
   (:e (-1.1475414691717838d0 0.886853427975566d0 0.9502659163977112d0))
   (:f1 (-1.0220986554462426d0 0.8634381628668902d0 0.9340257955988036d0))
   (:f2 (-1.1528544821234206d0 0.8860197772455265d0 1.161137404605751d0))
   (:f3 (-1.2283164260668735d0 0.9016008128657689d0 1.350175484776847d0))
   (:f4 (-1.3096986746453054d0 0.9200303618033738d0 1.530315895702089d0))
   (:f5 (-0.9943035029625983d0 0.8578128277127894d0 0.9577642172257439d0))
   (:f6 (-1.121800125662674d0 0.8797713404801859d0 1.2295660695092439d0))
   (:f7 (-1.0537460701325347d0 0.8698199135804592d0 0.9118385165065372d0))
   (:f8 (-1.100053012788766d0 0.8763664176038313d0 1.049170063978169d0))
   (:f9 (-1.1737434293234834d0 0.8901832518167362d0 1.1559884633208115d0))
   (:f10 (-1.0964097556034107d0 0.8756220175246138d0 1.0532502476118133d0))
   (:f11 (-1.1834433376643112d0 0.8920693385677766d0 1.188228016808688d0))
   (:f12 (-1.2900405092627496d0 0.915856374302533d0 1.5228414327767055d0))
   (:led-b1 (-1.3442546077497048d0 0.9288728950213248d0 1.650182997498141d0))
   (:led-b2 (-1.303556315298139d0 0.9183473409932759d0 1.4949930666148261d0))
   (:led-b3 (-1.1828067133828266d0 0.8919867131952248d0 1.1571690357792532d0))
   (:led-b4 (-1.1183781340649874d0 0.8802853439261519d0 1.0151072191128603d0))
   (:led-b5 (-1.0721608971775782d0 0.8736702319620786d0 0.8949483725156397d0))
   (:led-bh1 (-1.3184910287079434d0 0.9226460511809023d0 1.5916593675121415d0))
   (:led-rgb1 (-1.2557122456128527d0 0.9122229415548231d0 1.770617286183816d0))
   (:led-v1 (-1.0155318030613745d0 0.8701041735432494d0 2.205397352253281d0))
   (:led-v2 (-1.1706116836696407d0 0.8895095994891173d0 1.183990207539545d0))))

(diag "~&XYZ -> RGB/BT.470 NTSC (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  ((rgb :bt470-ntsc)
   (:a (-0.6747934279874269d0 0.9093276759111982d0 1.569241758914835d0))
   (:b (-0.621793305521767d0 0.935807027260569d0 1.029487904981633d0))
   (:c (-0.6079858791622406d0 0.9414075701705132d0 0.8798075220737203d0))
   (:d50 (-0.6127468390256977d0 0.9247201042464773d0 1.0470323433330533d0))
   (:d55 (-0.6070944799053422d0 0.9264224408086559d0 0.9928951402640778d0))
   (:d65 (-0.5994577600377456d0 0.929172393162428d0 0.9161970878196524d0))
   (:d75 (-0.5947009241619828d0 0.9313816095638264d0 0.8651053821227814d0))
   (:d93 (-0.589656672112362d0 0.9342982126602929d0 0.8078718374326582d0))
   (:dci (-0.5826784418969408d0 0.9064382398005056d0 0.9779207992301d0))
   (:e (-0.6208445026098688d0 0.9444625789104951d0 0.9532914722811549d0))
   (:f1 (-0.5927709655129099d0 0.9203538580507699d0 0.938774792978804d0))
   (:f2 (-0.627127674255019d0 0.9243305083041262d0 1.154446907270603d0))
   (:f3 (-0.648679169956086d0 0.92037042993108d0 1.3335645405760508d0))
   (:f4 (-0.6713848553876268d0 0.9174690909901271d0 1.503943055119918d0))
   (:f5 (-0.5869527434818083d0 0.9122807396548078d0 0.9617013600797896d0))
   (:f6 (-0.6224420067610525d0 0.9100038358105184d0 1.2197066575270434d0))
   (:f7 (-0.5994438428996453d0 0.9290258147377564d0 0.9172627930178622d0))
   (:f8 (-0.6127700735941468d0 0.9245910405218657d0 1.048175931306665d0))
   (:f9 (-0.6314345822212702d0 0.9294659188992047d0 1.1494035052380436d0))
   (:f10 (-0.6120725943924977d0 0.9233999927258905d0 1.0520940110453323d0))
   (:f11 (-0.6343851935764836d0 0.9282121287203251d0 1.1800081228365018d0))
   (:f12 (-0.6671908153565561d0 0.9136979407837142d0 1.496964726624207d0))
   (:led-b1 (-0.6827374728409576d0 0.9097753290804214d0 1.6173494994585738d0))
   (:led-b2 (-0.6688858948575039d0 0.9205073389938633d0 1.4704914353052352d0))
   (:led-b3 (-0.6333869343555535d0 0.931339061816784d0 1.1504639773419862d0))
   (:led-b4 (-0.6159549914826801d0 0.9319221237635189d0 1.0155301742510556d0))
   (:led-b5 (-0.6032220148530594d0 0.934474295189596d0 0.900907677959302d0))
   (:led-bh1 (-0.6754156323465231d0 0.9114881899862263d0 1.562032379325652d0))
   (:led-rgb1 (-0.6702676834405843d0 0.8693550829339226d0 1.7318295852769794d0))
   (:led-v1 (-0.643583338288538d0 0.7120387916282888d0 2.1441834036532503d0))
   (:led-v2 (-0.6315492844400324d0 0.9258182187077614d0 1.1760644981141817d0))))

(diag "~&XYZ -> RGB/BT.470 PAL/SECAM (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  ((rgb :bt470-pal/secam)
   (:a (-1.0293618792206198d0 0.9913189828150551d0 1.4599657443237986d0))
   (:b (-0.9554727319155237d0 0.9665149881222417d0 1.0399579269945467d0))
   (:c (-0.9381975565060534d0 0.9620791003105227d0 0.9139886356401787d0))
   (:d50 (-0.9474510293633246d0 0.9593456037226911d0 1.0546430793591772d0))
   (:d55 (-0.9403721532659083d0 0.9571979385678504d0 1.009960417467289d0))
   (:d65 (-0.9310128143739144d0 0.9547670468810501d0 0.9454749160695357d0))
   (:d75 (-0.9253307113460465d0 0.9536674053740134d0 0.90164661563531d0))
   (:d93 (-0.9195061949760079d0 0.9529950345822884d0 0.8515971107188138d0))
   (:dci (-0.9170638143461745d0 0.9411933821320624d0 0.998035888665262d0))
   (:e (-0.9522948993452187d0 0.9684370280595173d0 0.9763590421822035d0))
   (:f1 (-0.9253318478363995d0 0.9493705115168442d0 0.9648424038020333d0))
   (:f2 (-0.9649671095454202d0 0.9664252840505094d0 1.1414648105249092d0))
   (:f3 (-0.9929928710692844d0 0.9775107920866922d0 1.2819038026511334d0))
   (:f4 (-1.02275921350682d0 0.9906457056325119d0 1.411236690891426d0))
   (:f5 (-0.9205494877860433d0 0.9446181545532872d0 0.9843320055821989d0))
   (:f6 (-0.9631514214859355d0 0.9607968090317166d0 1.1934841984348479d0))
   (:f7 (-0.9310269764068567d0 0.9547157089454211d0 0.9463844322488877d0))
   (:f8 (-0.9475113332624395d0 0.9593236081565698d0 1.0555824740799284d0))
   (:f9 (-0.9688755099961524d0 0.9698495380253864d0 1.1373218651915178d0))
   (:f10 (-0.9469831232062503d0 0.9586894549897892d0 1.058817520069456d0))
   (:f11 (-0.9728706568255583d0 0.9711392591018679d0 1.161727987093777d0))
   (:f12 (-1.0184252109710583d0 0.9873533309419803d0 1.4060710522446034d0))
   (:led-b1 (-1.0394412478732966d0 0.9964636838872141d0 1.4954654912000216d0))
   (:led-b2 (-1.0187125694085877d0 0.9896532658291655d0 1.3860935747313887d0))
   (:led-b3 (-0.9707787009906335d0 0.971305726619504d0 1.1381271872374503d0))
   (:led-b4 (-0.9494709671243111d0 0.9627305602292422d0 1.02855657792163d0))
   (:led-b5 (-0.9341824884587259d0 0.9579448667245031d0 0.9322913447568008d0))
   (:led-bh1 (-1.0295718863091468d0 0.9920971521287049d0 1.4545917973811442d0))
   (:led-rgb1 (-1.034220131944187d0 0.9815306604768905d0 1.5794872924857115d0))
   (:led-v1 (-1.0381852169428907d0 0.9402188648848736d0 1.8717379865486266d0))
   (:led-v2 (-0.9700135292720334d0 0.9690918085019004d0 1.1586477761763865d0))))

(diag "~&XYZ -> RGB/BT.709 (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  ((rgb :bt709)
   (:a (-5.288162044208895d0 0.9879926434542414d0 1.6651600082950624d0))
   (:b (-4.315813026247519d0 0.9538354989841817d0 1.0544789746218473d0))
   (:c (-4.107532185884829d0 0.9477507378374117d0 0.8830615295286957d0))
   (:d50 (-4.215610222768887d0 0.9440047960607054d0 1.0747427739278472d0))
   (:d55 (-4.130573572931407d0 0.941063614384464d0 1.0129860517569584d0))
   (:d65 (-4.020090699849391d0 0.9377366296544329d0 0.925190387227123d0))
   (:d75 (-3.954167002403957d0 0.9362323532515993d0 0.8664619185738304d0))
   (:d93 (-3.887569286333264d0 0.9353127924144207d0 0.8003824391031042d0))
   (:dci (-3.8540712874271814d0 0.9191999282907954d0 0.9963993395101707d0))
   (:e (-4.278419687253994d0 0.9564742419237873d0 0.9672369562802503d0))
   (:f1 (-3.951999437887868d0 0.93035865910626d0 0.9512935282103963d0))
   (:f2 (-4.431864519493315d0 0.9537123787627082d0 1.196805313040417d0))
   (:f3 (-4.7925730703008895d0 0.9689498500970666d0 1.3995303275052364d0))
   (:f4 (-5.196819595807323d0 0.987062522837806d0 1.591591739412579d0))
   (:f5 (-3.8951523867210205d0 0.9238704098887691d0 0.9777252283814757d0))
   (:f6 (-4.406580178503601d0 0.9459931604832612d0 1.2710444470381208d0))
   (:f7 (-4.020228298473722d0 0.9376663908788374d0 0.9264160670015886d0))
   (:f8 (-4.216318778202318d0 0.9439746649174192d0 1.0760479783007166d0))
   (:f9 (-4.482051427279847d0 0.9584143263445084d0 1.1909697107954815d0))
   (:f10 (-4.209689636439225d0 0.9431060325495133d0 1.0805374659424367d0))
   (:f11 (-4.532562397242332d0 0.9601864018275628d0 1.2257005052512318d0))
   (:f12 (-5.1358841251013745d0 0.9825165332753771d0 1.583801511029429d0))
   (:led-b1 (-5.431903649950456d0 0.9951053747909948d0 1.7192101123035601d0))
   (:led-b2 (-5.141041683921917d0 0.9856917843495601d0 1.553888283587376d0))
   (:led-b3 (-4.506510357954118d0 0.9604151726382053d0 1.192130500881566d0))
   (:led-b4 (-4.241517156997211d0 0.948643897216574d0 1.03866687811175d0))
   (:led-b5 (-4.058493282275871d0 0.9420863221890181d0 0.9075022067954053d0))
   (:led-bh1 (-5.291498363931687d0 0.9890678753435378d0 1.6570219725151443d0))
   (:led-rgb1 (-5.35047569367764d0 0.9744864553097943d0 1.8482593179264697d0))
   (:led-v1 (-5.384744875021868d0 0.9178717517778978d0 2.3111637624216645d0))
   (:led-v2 (-4.495811046108903d0 0.9573734923691055d0 1.2212830154230123d0))))

(diag "~&XYZ -> RGB/CIE RGB (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  ((rgb :cie-rgb)
   (:a (-0.9713244950673107d0 0.9724049705207942d0 1.5441337344848114d0))
   (:b (-0.8243633282167095d0 0.878617060022278d0 1.0259944483222825d0))
   (:c (-0.7898277050360196d0 0.8600240672893986d0 0.8843361577775543d0))
   (:d50 (-0.8180802667312366d0 0.8736019030303558d0 1.042193479628881d0))
   (:d55 (-0.8044102697922241d0 0.8659217212228867d0 0.9906870328242082d0))
   (:d65 (-0.7860293400971505d0 0.856189149700946d0 0.9180279200022702d0))
   (:d75 (-0.7745543733476739d0 0.8505940860734816d0 0.8698823052143908d0))
   (:d93 (-0.7624458540694599d0 0.8452613773518373d0 0.8162532743640556d0))
   (:dci (-0.7782424349180908d0 0.849188998149215d0 0.9754360229105524d0))
   (:e (-0.8125307085209895d0 0.8728897826791688d0 0.9540052732266994d0))
   (:f1 (-0.7824900723804994d0 0.8531206965545044d0 0.9389488240551802d0))
   (:f2 (-0.8492340353693323d0 0.892415688786192d0 1.1449146215566914d0))
   (:f3 (-0.9012020210874546d0 0.9255012097000569d0 1.3169120814202957d0))
   (:f4 (-0.955024256268422d0 0.9618465874432337d0 1.4812324116218145d0))
   (:f5 (-0.7800327678793691d0 0.8508137832275188d0 0.9603019284722799d0))
   (:f6 (-0.855862094482654d0 0.8950891059132311d0 1.2069707287633933d0))
   (:f7 (-0.7861595811094655d0 0.8562376796487882d0 0.9190288143322758d0))
   (:f8 (-0.8182782917033481d0 0.8737033206718202d0 1.0432787284025062d0))
   (:f9 (-0.8525866530162748d0 0.8950675387985082d0 1.140298753704268d0))
   (:f10 (-0.8181961502104217d0 0.8735196843893853d0 1.0469624626935763d0))
   (:f11 (-0.8605205718417828d0 0.8999185504923198d0 1.169583948973396d0))
   (:f12 (-0.9497729230217009d0 0.9578044012850904d0 1.4743731763991645d0))
   (:led-b1 (-0.9884669615077747d0 0.9845848488615128d0 1.5907040212776908d0))
   (:led-b2 (-0.9461198427186263d0 0.9559907945113808d0 1.4490072546375314d0))
   (:led-b3 (-0.8546617842101791d0 0.8965746722818694d0 1.1413943906251431d0))
   (:led-b4 (-0.8165066632073422d0 0.8735352224817424d0 1.0125079186036403d0))
   (:led-b5 (-0.7877592210224266d0 0.8578704929744405d0 0.9038603589494394d0))
   (:led-bh1 (-0.9704170168499293d0 0.9719908110397653d0 1.5372215136713427d0))
   (:led-rgb1 (-1.0020574453852396d0 0.9902926123476579d0 1.7005889694644487d0))
   (:led-v1 (-1.0807719988434445d0 1.0354517817838687d0 2.098449336591756d0))
   (:led-v2 (-0.8571146820269699d0 0.8975091343952246d0 1.1657030111043356d0))))

(diag "~&XYZ -> RGB/ColorMatch RGB (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  ((rgb :colormatch-rgb)
   (:a (-0.920375887683574d0 0.9943157552157583d0 1.821013399691491d0))
   (:b (-0.8330410078916876d0 0.9741474310274212d0 1.0715381617741178d0))
   (:c (-0.8125799118730385d0 0.9708662318776518d0 0.8749003009871976d0))
   (:d50 (-0.8210296593316747d0 0.9620151485992074d0 1.0954252695171514d0))
   (:d55 (-0.8125957624082187d0 0.96009523886843d0 1.0235514504667642d0))
   (:d65 (-0.8014866600646701d0 0.9581915896067245d0 0.9228440928856257d0))
   (:d75 (-0.7947804726354833d0 0.9576442595149681d0 0.8564736388196794d0))
   (:d93 (-0.7879297287654364d0 0.9578146328315452d0 0.7827803713588687d0))
   (:dci (-0.7800847156888364d0 0.9347599473630397d0 1.0048091585765553d0))
   (:e (-0.8306990658793454d0 0.9793487839045173d0 0.9704922735322846d0))
   (:f1 (-0.7928560217895563d0 0.9489333280103924d0 0.9527733038782951d0))
   (:f2 (-0.8426062669177036d0 0.9701220099878967d0 1.239843185726922d0))
   (:f3 (-0.8766574119857851d0 0.9817302002744295d0 1.486406658566434d0))
   (:f4 (-0.9134950108906903d0 0.996230039107337d0 1.7270464132352537d0))
   (:f5 (-0.7854672311176017d0 0.9406947832419753d0 0.9832111520882637d0))
   (:f6 (-0.837612821242994d0 0.9587008298354529d0 1.3294193064229354d0))
   (:f7 (-0.8014783193428332d0 0.9580823267706203d0 0.9242401831909464d0))
   (:f8 (-0.8210797860074718d0 0.9619456302632825d0 1.0969551387866345d0))
   (:f9 (-0.8484270390874364d0 0.975867377122407d0 1.2327757933641341d0))
   (:f10 (-0.8202019256116317d0 0.9608027920024843d0 1.1022346795019136d0))
   (:f11 (-0.8531363076313009d0 0.976944051437355d0 1.2744144273930693d0))
   (:f12 (-0.9073272679518621d0 0.9910735988810867d0 1.7172135248661347d0))
   (:led-b1 (-0.9332831777139218d0 1.0005810372667674d0 1.8905365786966446d0))
   (:led-b2 (-0.9089450043315034d0 0.9960740927390507d0 1.679257945570073d0))
   (:led-b3 (-0.8511425952406295d0 0.9782070291826025d0 1.2341288581854009d0))
   (:led-b4 (-0.8248818698240433d0 0.9684094041053048d0 1.0532114707295939d0))
   (:led-b5 (-0.8063663966370399d0 0.9636900394377537d0 0.9026627119504713d0))
   (:led-bh1 (-0.9210336826938123d0 0.9959566096714649d0 1.8105580034182154d0))
   (:led-rgb1 (-0.919503555237486d0 0.9696404118377533d0 2.058915497128146d0))
   (:led-v1 (-0.9000136928129869d0 0.8733964794687679d0 2.682817019036054d0))
   (:led-v2 (-0.8491381509952599d0 0.9737379176734932d0 1.269149770043107d0))))

(diag "~&XYZ -> RGB/DCI-P3 (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  ((rgb :dci-p3)
   (:a (-0.9552300272142262d0 0.9637501423284327d0 1.457019199217183d0))
   (:b (-0.8780191930128999d0 0.937389759963083d0 1.0242258927864247d0))
   (:c (-0.859783723767922d0 0.9327603476102511d0 0.8993032259919133d0))
   (:d50 (-0.86989249879038d0 0.9300460389349792d0 1.0385458827839107d0))
   (:d55 (-0.8624539874861739d0 0.9278036755300489d0 0.993723369703086d0))
   (:d65 (-0.8525737071186962d0 0.9252772108461599d0 0.9296902046591733d0))
   (:d75 (-0.8465342447106164d0 0.9241441949923768d0 0.8866794299283176d0))
   (:d93 (-0.8402920089404099d0 0.9234680211439191d0 0.8381519939074508d0))
   (:dci (-0.8385202921705254d0 0.9114248764264449d0 0.980917976673688d0))
   (:e (-0.8744909971038077d0 0.9393117374605819d0 0.9610429207523697d0))
   (:f1 (-0.8468429321560085d0 0.9197628506251696d0 0.9484594699787636d0))
   (:f2 (-0.8881600794913581d0 0.9374236446029232d0 1.126640226847746d0))
   (:f3 (-0.9173546944346472d0 0.9490791831931139d0 1.2710809016724471d0))
   (:f4 (-0.9482588217124607d0 0.9629233304167691d0 1.405974263614861d0))
   (:f5 (-0.8420312508965752d0 0.9149146670106029d0 0.9674877289377655d0))
   (:f6 (-0.8865517833811258d0 0.9317264081858709d0 1.179435203349485d0))
   (:f7 (-0.8525925367469281d0 0.9252249645229857d0 0.9305823055608881d0))
   (:f8 (-0.8699583460707535d0 0.9300244511026948d0 1.039487944887718d0))
   (:f9 (-0.8921246008570226d0 0.9409369378718763d0 1.1226012374686638d0))
   (:f10 (-0.8694332947648394d0 0.9293774521639605d0 1.0427027905635433d0))
   (:f11 (-0.8963063317536356d0 0.9423004323581325d0 1.1474912064539087d0))
   (:f12 (-0.9438329990060813d0 0.9595138375762793d0 1.4004561199401253d0))
   (:led-b1 (-0.9656557733887106d0 0.9691620890674204d0 1.4944895019122617d0))
   (:led-b2 (-0.9440159143392214d0 0.9618349680159792d0 1.3796938032638804d0))
   (:led-b3 (-0.8940675104912937d0 0.9424354725799549d0 1.1234921408108374d0))
   (:led-b4 (-0.8718389573563873d0 0.9334934990848996d0 1.0126044977224704d0))
   (:led-b5 (-0.8557585136609349d0 0.9285276029483974d0 0.9169409390940942d0))
   (:led-bh1 (-0.9554121982274432d0 0.9645380278939708d0 1.4514098549822958d0))
   (:led-rgb1 (-0.9608823500508279d0 0.9540267245551288d0 1.5826938588337407d0))
   (:led-v1 (-0.967042004848454d0 0.9128295210122378d0 1.8941088577586827d0))
   (:led-v2 (-0.8933816344269213d0 0.9401903452595115d0 1.1442541023454338d0))))

(diag "~&XYZ -> RGB/DCI-P3+ (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  ((rgb :dci-p3+)
   (:a (-0.63248277591624d0 1.0227920487702784d0 1.4337646662607446d0))
   (:b (-0.6537930635971556d0 0.9105404811892082d0 1.0161533569906778d0))
   (:c (-0.6550318855275709d0 0.8869886589047886d0 0.897076547067617d0))
   (:d50 (-0.6426211579745631d0 0.9075398603757057d0 1.02957266796245d0))
   (:d55 (-0.6428963340839542d0 0.8980583125441627d0 0.9866580521668165d0))
   (:d65 (-0.6431650060419918d0 0.8857627285898864d0 0.9255748413919007d0))
   (:d75 (-0.6433554696908467d0 0.8784454646124417d0 0.8847297487854895d0))
   (:d93 (-0.643555092585277d0 0.8711711473762457d0 0.838866385490154d0))
   (:dci (-0.6198388886679386d0 0.8835220831335353d0 0.9738057348921063d0))
   (:e (-0.6607502148283199d0 0.9014881702362776d0 0.9559786426596123d0))
   (:f1 (-0.6342262030612028d0 0.8844901255060292d0 0.9431947984075566d0))
   (:f2 (-0.6445149078591504d0 0.9295280020739368d0 1.1142766405419327d0))
   (:f3 (-0.642679276841762d0 0.9682385852005192d0 1.25367291908035d0))
   (:f4 (-0.6403983192973401d0 1.0094502774174698d0 1.3843455040103003d0))
   (:f5 (-0.625953908253793d0 0.8839046930275806d0 0.9611284783809482d0))
   (:f6 (-0.6307879823125988d0 0.936104916761611d0 1.1648592234913506d0))
   (:f7 (-0.643046107824324d0 0.8858606119827697d0 0.9264202873740185d0))
   (:f8 (-0.6425138285138351d0 0.9076921062620519d0 1.0304731907873683d0))
   (:f9 (-0.6496615828580785d0 0.9313141017207608d0 1.1105138616759846d0))
   (:f10 (-0.6413488480608448d0 0.9077844671709352d0 1.033525886990232d0))
   (:f11 (-0.6488584607214243d0 0.9372190607350357d0 1.134465319946201d0))
   (:f12 (-0.6367735789738153d0 1.0057980956733905d0 1.3789249104968186d0))
   (:led-b1 (-0.6327359824468767d0 1.0360030469444228d0 1.4701759772703937d0))
   (:led-b2 (-0.6433146141116924d0 1.0023094448471739d0 1.358903979093034d0))
   (:led-b3 (-0.6515681679868752d0 0.9325883296149706d0 1.111418762524747d0))
   (:led-b4 (-0.6494011756904856d0 0.9055856200231724d0 1.004903191449885d0))
   (:led-b5 (-0.6483723228871073d0 0.8863226014113493d0 0.9136092067697846d0))
   (:led-bh1 (-0.6345751210714702d0 1.0218855895870884d0 1.4283521757456688d0))
   (:led-rgb1 (-0.5925046355900954d0 1.0501469800554222d0 1.555372154860208d0))
   (:led-v1 (-0.4008713579685137d0 1.1225233848599394d0 1.857422915640075d0))
   (:led-v2 (-0.6463819569069847d0 0.9350348543635388d0 1.1312869721967593d0))))

(diag "~&XYZ -> RGB/Don RGB 4 (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  ((rgb :don-rgb-4)
   (:a (-0.6255983238053435d0 0.9555831411568361d0 1.55018215883169d0))
   (:b (-0.5846203538302502d0 0.9072576773907749d0 1.0296040562406998d0))
   (:c (-0.5732100537608098d0 0.8983464728660867d0 0.8872046198582059d0))
   (:d50 (-0.5752560790081757d0 0.8997415923663583d0 1.0458865924989074d0))
   (:d55 (-0.5705526885799878d0 0.8957729663918463d0 0.9941187900556268d0))
   (:d65 (-0.5641554507813488d0 0.8910246883216072d0 0.9210792901897444d0))
   (:d75 (-0.5601500441541598d0 0.8885738167496423d0 0.8726720872072788d0))
   (:d93 (-0.5558695481307926d0 0.886587869957568d0 0.818740090915415d0))
   (:dci (-0.546309699099973d0 0.8775423182340916d0 0.9787897241084138d0))
   (:e (-0.584937227271212d0 0.907318439911677d0 0.9572442544236508d0))
   (:f1 (-0.5571043177260236d0 0.8855745607133324d0 0.9421116769499713d0))
   (:f2 (-0.5875964391401454d0 0.9110760799428226d0 1.1491128213212454d0))
   (:f3 (-0.6053050640636216d0 0.9300224922391975d0 1.321923793088601d0))
   (:f4 (-0.6239215561080197d0 0.9518483654569002d0 1.4869957147412305d0))
   (:f5 (-0.5508865064424481d0 0.880895822586079d0 0.9635769843582219d0))
   (:f6 (-0.5815062118005792d0 0.9070805329608654d0 1.2114692588217344d0))
   (:f7 (-0.5641251691731668d0 0.8909938742595929d0 0.9220855399132187d0))
   (:f8 (-0.57525846936034d0 0.8997512736383498d0 1.0469773004890177d0))
   (:f9 (-0.5920145938571836d0 0.9147405420873574d0 1.1444734235170324d0))
   (:f10 (-0.5744878135891507d0 0.8991603449488039d0 1.0506796673220928d0))
   (:f11 (-0.594349132307112d0 0.9172215421785334d0 1.17389992529746d0))
   (:f12 (-0.6198713651983808d0 0.9478698960299112d0 1.4801066153842801d0))
   (:led-b1 (-0.632290606122893d0 0.9635813703467406d0 1.5969603114300837d0))
   (:led-b2 (-0.6222735508132103d0 0.949266371407699d0 1.4546239170895976d0))
   (:led-b3 (-0.5939486656972622d0 0.9164082929220969d0 1.14557388213473d0))
   (:led-b4 (-0.5790277053319896d0 0.9026084869755219d0 1.0160501289770127d0))
   (:led-b5 (-0.5681489636894017d0 0.8942071118431679d0 0.90683533729896d0))
   (:led-bh1 (-0.6264272041961052d0 0.9561116442869518d0 1.5432383468394322d0))
   (:led-rgb1 (-0.6161520465366518d0 0.9528925974235092d0 1.7073429731990923d0))
   (:led-v1 (-0.5725922512374064d0 0.9341713247839487d0 2.106963670664635d0))
   (:led-v2 (-0.5915874997448763d0 0.9147938401165395d0 1.1700009677346292d0))))

(diag "~&XYZ -> RGB/ECI RGB v2 (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  ((rgb :eci-rgb-v2)
   (:a (-3.5077525046289475d0 0.9478051260497314d0 1.46020588267725d0))
   (:b (-2.9161119363070958d0 0.9489605930299995d0 1.0267008021745256d0))
   (:c (-2.770158436256281d0 0.9497130238306896d0 0.8959090121554877d0))
   (:d50 (-2.821246361588179d0 0.9401791964976983d0 1.0417607611600759d0))
   (:d55 (-2.762229965012922d0 0.9400360973513399d0 0.9953698582774072d0))
   (:d65 (-2.6832918479075607d0 0.9402935618437526d0 0.9283852229336865d0))
   (:d75 (-2.6345184428531434d0 0.9408972186731687d0 0.8828622020652689d0))
   (:d93 (-2.583052150778704d0 0.9420544349526508d0 0.8309169021148161d0))
   (:dci (-2.5163261009824263d0 0.9227490098973569d0 0.9826216072089214d0))
   (:e (-2.9053770957489564d0 0.9541232746227598d0 0.9607928969781688d0))
   (:f1 (-2.6160828296003125d0 0.9334355903731201d0 0.9483530002109976d0))
   (:f2 (-2.973757150866317d0 0.9432631873728518d0 1.131832888806315d0))
   (:f3 (-3.2097087379007063d0 0.9465229903258422d0 1.2770466637605022d0))
   (:f4 (-3.4679691386913536d0 0.9513771456766692d0 1.4102369068523006d0))
   (:f5 (-2.558340015230869d0 0.9272347616439721d0 0.9684727374736873d0))
   (:f6 (-2.924236005354119d0 0.9335998611465325d0 1.1855139144373403d0))
   (:f7 (-2.6831633636045042d0 0.9401971142363018d0 0.9293279716949862d0))
   (:f8 (-2.8214974156561095d0 0.9401051880745804d0 1.0427341535292083d0))
   (:f9 (-3.019969338189704d0 0.9473773673577731d0 1.127615809748244d0))
   (:f10 (-2.8142700039324797d0 0.939223522958487d0 1.0460737870959262d0))
   (:f11 (-3.052038514005422d0 0.9473618450659723d0 1.1528844594323364d0))
   (:f12 (-3.419585745048477d0 0.947986994015145d0 1.404887358660775d0))
   (:led-b1 (-3.6010189831259005d0 0.9505129604315602d0 1.4966228625549718d0))
   (:led-b2 (-3.438994618543126d0 0.9523605107945258d0 1.3844139000777214d0))
   (:led-b3 (-3.041058538203645d0 0.9489733175180101d0 1.1284787307915587d0))
   (:led-b4 (-2.8544943825451146d0 0.9453007767929796d0 1.0147900273804356d0))
   (:led-b5 (-2.7214731595730206d0 0.9443817433975058d0 0.9147865038506252d0))
   (:led-bh1 (-3.514975391218333d0 0.9492132891326363d0 1.454711032143875d0))
   (:led-rgb1 (-3.455799762576724d0 0.9240180718210097d0 1.5823010580737016d0))
   (:led-v1 (-3.1560622765390165d0 0.8300025205658851d0 1.878889483392374d0))
   (:led-v2 (-3.021361944554343d0 0.9452343330078327d0 1.1496590690085575d0))))

(diag "~&XYZ -> RGB/Ekta Space PS 5 (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  ((rgb :ekta-space-ps5)
   (:a (-0.673920700846102d0 0.983995752648733d0 1.5596378974590581d0))
   (:b (-0.6592312510395155d0 0.9155727336719052d0 1.0298482401614832d0))
   (:c (-0.6535399326302064d0 0.9024278819455634d0 0.8839887434938369d0))
   (:d50 (-0.6482363611384817d0 0.9088151089261203d0 1.0467285147832435d0))
   (:d55 (-0.6457202031099847d0 0.9032051801139094d0 0.9938301125360625d0))
   (:d65 (-0.6423327491539961d0 0.8962641926076069d0 0.9190503418933638d0))
   (:d75 (-0.6402907215059631d0 0.8924402841010053d0 0.8693708971946001d0))
   (:d93 (-0.6381841786045803d0 0.8890020623787623d0 0.8138802383749948d0))
   (:dci (-0.6204898990123919d0 0.8849282115640481d0 0.978660519429465d0))
   (:e (-0.6629934905146967d0 0.91329308590711d0 0.955664430853978d0))
   (:f1 (-0.6338138650839988d0 0.8915861930335237d0 0.9408131661247846d0))
   (:f2 (-0.6563183524715736d0 0.9235606535715695d0 1.151960374371916d0))
   (:f3 (-0.6660285981709404d0 0.9488701824107731d0 1.327801962811614d0))
   (:f4 (-0.6764731262532162d0 0.9773268865862075d0 1.4954331608156264d0))
   (:f5 (-0.6261338264341517d0 0.8877017221543755d0 0.9629705030557567d0))
   (:f6 (-0.6460469434414429d0 0.9221454405400032d0 1.2157051836327646d0))
   (:f7 (-0.6422536146511912d0 0.8962645737417684d0 0.9200847662315105d0))
   (:f8 (-0.6481836029900244d0 0.9088622981179227d0 1.0478444426112665d0))
   (:f9 (-0.6614465830649833d0 0.9269339597544246d0 1.1471294108127312d0))
   (:f10 (-0.6471575483348183d0 0.9084162694859658d0 1.0516493959287956d0))
   (:f11 (-0.662427666888821d0 0.9304568695661971d0 1.17712058206461d0))
   (:f12 (-0.672269742663553d0 0.9732026617338219d0 1.4884996615950388d0))
   (:led-b1 (-0.6782897402825221d0 0.9939662654335009d0 1.607059379014564d0))
   (:led-b2 (-0.6767882979343415d0 0.9733177470483864d0 1.4625408676896907d0))
   (:led-b3 (-0.663523913970951d0 0.9285907157396817d0 1.1482114977341897d0))
   (:led-b4 (-0.6538167371334714d0 0.9105913133799536d0 1.0160997731671697d0))
   (:led-b5 (-0.647252322321688d0 0.8989497213478312d0 0.9043126456722304d0))
   (:led-bh1 (-0.6753927194028996d0 0.9841492319823428d0 1.552566369266343d0))
   (:led-rgb1 (-0.6503386423815948d0 0.98981893541935d0 1.7194143821314314d0))
   (:led-v1 (-0.5530020762704569d0 0.9980075083133157d0 2.1251854320574775d0))
   (:led-v2 (-0.659583145141139d0 0.9279580428204758d0 1.1731991756529054d0))))

(diag "~&XYZ -> RGB/ProPhoto RGB (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  ((rgb :prophoto-rgb)
   (:a (0.2822639543852274d0 0.8940618919256973d0 1.6903110600216569d0))
   (:b (-0.191379992349052d0 0.8402669225067629d0 1.0299017033009483d0))
   (:c (-0.2413068381259933d0 0.8306209539111856d0 0.8612235538011203d0))
   (:d50 (-0.1654078880144716d0 0.8319622249065345d0 1.049394027640531d0))
   (:d55 (-0.1881919980475086d0 0.8276436503137753d0 0.9871293617536195d0))
   (:d65 (-0.2145858305951467d0 0.8225270143871424d0 0.9005995831697319d0))
   (:d75 (-0.2293345736757762d0 0.8199304563882229d0 0.8441552227403719d0))
   (:d93 (-0.2436033060288496d0 0.8178890087069721d0 0.7821737041295329d0))
   (:dci (-0.1556606148534533d0 0.8077105922397706d0 0.9684969054879099d0))
   (:e (-0.228257890055187d0 0.840405769252342d0 0.9435393927776975d0))
   (:f1 (-0.1940887536710401d0 0.8165283873903163d0 0.9252136985271127d0))
   (:f2 (-0.1090405553387081d0 0.8444162637001611d0 1.175751583294344d0))
   (:f3 (0.1318898159367522d0 0.86542671017695d0 1.3931351475095815d0))
   (:f4 (0.2395930231743749d0 0.8898581290193819d0 1.607029583165975d0))
   (:f5 (-0.1726759271041824d0 0.811387256394439d0 0.950495197918693d0))
   (:f6 (0.0599211512536193d0 0.8399726567395834d0 1.2531957012646147d0))
   (:f7 (-0.2140904959291221d0 0.8224916564864181d0 0.9017788702554976d0))
   (:f8 (-0.1647032290035073d0 0.8319720114240734d0 1.050712407277356d0))
   (:f9 (-0.1243473507345037d0 0.8484780153573402d0 1.1700892129666276d0))
   (:f10 (-0.1608474070694458d0 0.8313182648599063d0 1.0551781062487926d0))
   (:f11 (-0.1007587795079608d0 0.8512181241504109d0 1.206556626511431d0))
   (:f12 (0.2403685992366864d0 0.8853903082575332d0 1.597944454544797d0))
   (:led-b1 (0.3055114715606074d0 0.9030761785951561d0 1.7525415964064235d0))
   (:led-b2 (0.2174474586139407d0 0.8869568080966231d0 1.5646622999973692d0))
   (:led-b3 (-0.1278406803819417d0 0.8503270867279586d0 1.1714775881516797d0))
   (:led-b4 (-0.1898499526436128d0 0.835147232524808d0 1.0135185847654813d0))
   (:led-b5 (-0.226447960595212d0 0.8260404700696423d0 0.8839993306094014d0))
   (:led-bh1 (0.2764116386580092d0 0.8946558548063184d0 1.6811340023968304d0))
   (:led-rgb1 (0.3918614910644839d0 0.8910587176415852d0 1.9006119887748845d0))
   (:led-v1 (0.6413109933684659d0 0.8702009818616172d0 2.454648424066817d0))
   (:led-v2 (-0.0973821560176583d0 0.8485266119337515d0 1.2016752497163201d0))))

(diag "~&XYZ -> RGB/Simple sRGB (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  ((rgb :simple-srgb)
   (:a (-1.0761185295114777d0 0.9889645393205957d0 1.6129334358745067d0))
   (:b (-0.9811830767308323d0 0.9575789114910006d0 1.0500844626963028d0))
   (:c (-0.9593689629593471d0 0.951988938716956d0 0.8925806775543949d0))
   (:d50 (-0.9707618437070623d0 0.9485477650087507d0 1.0687198550313535d0))
   (:d55 (-0.961811423848679d0 0.9458459639618152d0 1.0119363091649385d0))
   (:d65 (-0.9500312276196504d0 0.9427898531247526d0 0.9312659848420315d0))
   (:d75 (-0.9429178577187679d0 0.9414080832475331d0 0.877342458497001d0))
   (:d93 (-0.9356657668346181d0 0.9405634203647523d0 0.8167090817129862d0))
   (:dci (-0.9319924133366996d0 0.9257641811339835d0 0.996690654639956d0))
   (:e (-0.9773097100953217d0 0.9600031839952313d0 0.9698917642989654d0))
   (:f1 (-0.942682876503034d0 0.936012930412877d0 0.9552436037890708d0))
   (:f2 (-0.9930889841694535d0 0.957465799671029d0 1.181040283477718d0))
   (:f3 (-1.0290456702661288d0 0.9714656323126983d0 1.367817404521092d0))
   (:f4 (-1.0676293694494112d0 0.9881097554599849d0 1.545006652325888d0))
   (:f5 (-0.9364949220866382d0 0.9300536530407207d0 0.9795291623583741d0))
   (:f6 (-0.9905096485880809d0 0.9503743415160886d0 1.2494072001857897d0))
   (:f7 (-0.9500460081285195d0 0.9427253340626252d0 0.9323917232766922d0))
   (:f8 (-0.9708360060589556d0 0.948520085826683d0 1.0699202846712408d0))
   (:f9 (-0.9981850366405857d0 0.9617856222612996d0 1.1756679179958527d0))
   (:f10 (-0.9701418879141018d0 0.9477221430282451d0 1.0740494833270389d0))
   (:f11 (-1.0032826640904442d0 0.9634137324220361d0 1.2076453224840877d0))
   (:f12 (-1.0619208249822139d0 0.9839320828264804d0 1.5378155331916652d0))
   (:led-b1 (-1.08931714274524d0 0.995501406283289d0 1.6628570868650696d0))
   (:led-b2 (-1.062405420654432d0 0.9868500558275858d0 1.5102059273689281d0))
   (:led-b3 (-1.0006573526357043d0 0.963623919651713d0 1.176736543716833d0))
   (:led-b4 (-0.973469037743232d0 0.9528094494496101d0 1.035545326457176d0))
   (:led-b5 (-0.9541456833633126d0 0.9467854255838059d0 0.9150216134677147d0))
   (:led-bh1 (-1.0764270795663429d0 0.9899526901178418d0 1.605418024829913d0))
   (:led-rgb1 (-1.0818640099755334d0 0.9765530371250184d0 1.7821138802768663d0))
   (:led-v1 (-1.0850081692706592d0 0.924544391185356d0 2.2105166883186858d0))
   (:led-v2 (-0.9995767658710897d0 0.9608293596047d0 1.2035775679045337d0))))

(diag "~&XYZ -> RGB/SMPTE-C RGB (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  ((rgb :smpte-c-rgb)
   (:a (-1.140192358686411d0 0.9938647477245576d0 1.6091074714384148d0))
   (:b (-1.037014571433858d0 0.9733456789273276d0 1.048245558815799d0))
   (:c (-1.0135043456717683d0 0.9698795104590242d0 0.8914140077883886d0))
   (:d50 (-1.0263645659012381d0 0.9636109984907689d0 1.0667881927552656d0))
   (:d55 (-1.016728810641255d0 0.9617309198423171d0 1.0102320648686496d0))
   (:d65 (-1.004061910194706d0 0.9597665106498496d0 0.9299031023572629d0))
   (:d75 (-0.9964217307233002d0 0.9590682843558281d0 0.8762230182986566d0))
   (:d93 (-0.9886461012848d0 0.9589476231813503d0 0.8158821660871627d0))
   (:dci (-0.9858408743813032d0 0.9410170413298601d0 0.9950117540375352d0))
   (:e (-1.0324975617621581d0 0.9771299794914254d0 0.9683956054217155d0))
   (:f1 (-0.9966120466688314d0 0.952352621776988d0 0.9537612198336195d0))
   (:f2 (-1.0502889399990563d0 0.9708843389152157d0 1.1786866462830188d0))
   (:f3 (-1.089076146587062d0 0.9816167379703294d0 1.364804614161583d0))
   (:f4 (-1.1307056498537136d0 0.9947818998940229d0 1.5414069039965819d0))
   (:f5 (-0.9903748690250994d0 0.9457659087639179d0 0.9779307078528764d0))
   (:f6 (-1.0481835706904774d0 0.962091992284457d0 1.2467873464646557d0))
   (:f7 (-1.0040835999352828d0 0.9596831726892096d0 0.9310236918762467d0))
   (:f8 (-1.0264496529915343d0 0.9635615665897145d0 1.0679837460421397d0))
   (:f9 (-1.055518541096723d0 0.9755023087972808d0 1.173342132917945d0))
   (:f10 (-1.0257611956505084d0 0.9626577352493093d0 1.0720949001660294d0))
   (:f11 (-1.0610453817413048d0 0.9765852270190956d0 1.2052015268437826d0))
   (:f12 (-1.124727513425426d0 0.990569194765618d0 1.5342344070245804d0))
   (:led-b1 (-1.1543774696666542d0 0.9993739179623781d0 1.6588743339355783d0))
   (:led-b2 (-1.124950817269393d0 0.9943504691406587d0 1.506722329539199d0))
   (:led-b3 (-1.0580850096657521d0 0.9774028639347969d0 1.1744098921517143d0))
   (:led-b4 (-1.0289373343901773d0 0.9686113876232134d0 1.0337567888502355d0))
   (:led-b5 (-1.0082234191534278d0 0.9641572068402641d0 0.9137403238111801d0))
   (:led-bh1 (-1.140431876792429d0 0.9951132409339594d0 1.6016183279815355d0))
   (:led-rgb1 (-1.148034968661057d0 0.975719909506437d0 1.7777210010588993d0))
   (:led-v1 (-1.1571246251618226d0 0.903429065834595d0 2.2047421134849667d0))
   (:led-v2 (-1.0571788021739805d0 0.9739628285744996d0 1.201144661154601d0))))

(diag "~&XYZ -> RGB/sRGB (one way)")
(define-test/one-way (xyz 0.1d0 0.5d0 0.9d0)
  ((rgb :srgb)
   (:a (-15.182900802484204d0 0.9893228630346848d0 1.5801874079070426d0))
   (:b (-12.391178733137322d0 0.9589016232427362d0 1.0483365525021984d0))
   (:c (-11.793181298140443d0 0.9534747681841053d0 0.8956324843330857d0))
   (:d50 (-12.103485350705338d0 0.9501326895746073d0 1.0662720959460765d0))
   (:d55 (-11.859335680505286d0 0.947507984021898d0 1.0115376891790195d0))
   (:d65 (-11.542127076012028d0 0.9445383256037112d0 0.9333332088203351d0))
   (:d75 (-11.352852815790916d0 0.9431953805447133d0 0.8807449916379572d0))
   (:d93 (-11.161643373205727d0 0.942374370022653d0 0.8212894084321537d0))
   (:dci (-11.065466896346486d0 0.9279795178257846d0 0.9967991454268105d0))
   (:e (-12.283818302071468d0 0.9612543329666813d0 0.9708458957869069d0))
   (:f1 (-11.346629497224724d0 0.9379502448102552d0 0.9566347827414495d0))
   (:f2 (-12.724375464856363d0 0.9587918382917927d0 1.1738393540912493d0))
   (:f3 (-13.760009792952777d0 0.9723717366939281d0 1.3508691727702746d0))
   (:f4 (-14.92064648396236d0 0.9884954212202338d0 1.5169495987721873d0))
   (:f5 (-11.183415296985686d0 0.9321537408489478d0 0.9801859820376234d0))
   (:f6 (-12.651781312503672d0 0.9519067919451548d0 1.2388913127619472d0))
   (:f7 (-11.542522136951218d0 0.9444756230434093d0 0.934428316225063d0))
   (:f8 (-12.1055196920831d0 0.9501058033754025d0 1.0674265455197822d0))
   (:f9 (-12.868467653434584d0 0.962983839059223d0 1.1687144017476856d0))
   (:f10 (-12.086486689509952d0 0.9493306927781929d0 1.0713967600867746d0))
   (:f11 (-13.013490260526874d0 0.9645633666414394d0 1.1991907100355446d0))
   (:f12 (-14.745693976957725d0 0.9844505209098361d0 1.5102414830712523d0))
   (:led-b1 (-15.595598923857754d0 0.9956486681986542d0 1.6265229851539267d0))
   (:led-b2 (-14.760501901393592d0 0.9872759069635372d0 1.4844619148462874d0))
   (:led-b3 (-12.938691961059378d0 0.9647672656940421d0 1.1697339693414983d0))
   (:led-b4 (-12.177867037423104d0 0.9542715019954128d0 1.0343250227399365d0))
   (:led-b5 (-11.652385157112056d0 0.9484207090091613d0 0.9175184878227428d0))
   (:led-bh1 (-15.192479747110534d0 0.9902793315006496d0 1.5732018722002712d0))
   (:led-rgb1 (-15.361810213847804d0 0.9773024904381756d0 1.7367467471076496d0))
   (:led-v1 (-15.460200841173897d0 0.9267922069713425d0 2.1279231223473003d0))
   (:led-v2 (-12.90797304793934d0 0.9620560072957473d0 1.1953176754083927d0))))

(finalize)
