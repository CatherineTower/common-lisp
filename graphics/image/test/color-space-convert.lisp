(in-package #:mfiano.graphics.image.test)

(plan 827)

(diag "~&From XYZ (one way)")
(define-tests/one-way (xyz 0.1d0 0.5d0 0.9d0)
  (xyy (0.0666666666666667d0 0.3333333333333333d0 0.5d0))
  (lab (76.06926101415557d0 -164.77082131141094d0 -34.357771724305984d0))
  (lch-ab (76.06926101415557d0 168.3148241644105d0 191.7784589134084d0))
  (luv (76.06926101415557d0 -169.78565769536613d0 -36.382640934721316d0))
  (lch-uv (76.06926101415557d0 173.64004757092442d0 192.09475707701208d0))
  ((rgb :adobe-rgb) (-0.6736754584571568d0 0.9599892636483003d0 0.9694763728683282d0))
  ((rgb :adobe-wide-gamut-rgb) (-0.4714769965672789d0 0.8709942567984879d0 0.9587101446485923d0))
  ((rgb :apple-rgb) (-0.9003766733271247d0 0.9761424165890683d0 0.9647357920730901d0))
  ((rgb :best-rgb) (-0.5829326261753534d0 0.8674757718794868d0 0.9545119205269107d0))
  ((rgb :beta-rgb) (-0.5512984380145708d0 0.9199903868988205d0 0.9552656747406622d0))
  ((rgb :bruce-rgb) (-0.8674889353650704d0 0.9600031839952312d0 0.9694661774457546d0))
  ((rgb :bt2020) (-1.1475414691717838d0 0.886853427975566d0 0.9502659163977112d0))
  ((rgb :bt470-ntsc) (-0.6208445026098688d0 0.9444625789104951d0 0.9532914722811549d0))
  ((rgb :bt470-pal/secam) (-0.9522948993452187d0 0.9684370280595173d0 0.9763590421822035d0))
  ((rgb :bt709) (-4.278419687253994d0 0.9564742419237873d0 0.9672369562802503d0))
  ((rgb :cie-rgb) (-0.8125307085209895d0 0.8728897826791688d0 0.9540052732266994d0))
  ((rgb :colormatch-rgb) (-0.8306990658793454d0 0.9793487839045173d0 0.9704922735322846d0))
  ((rgb :dci-p3) (-0.8744909971038077d0 0.9393117374605819d0 0.9610429207523697d0))
  ((rgb :dci-p3+) (-0.6607502148283199d0 0.9014881702362776d0 0.9559786426596123d0))
  ((rgb :don-rgb-4) (-0.584937227271212d0 0.907318439911677d0 0.9572442544236508d0))
  ((rgb :eci-rgb-v2) (-2.9053770957489564d0 0.9541232746227598d0 0.9607928969781688d0))
  ((rgb :ekta-space-ps5) (-0.6629934905146967d0 0.91329308590711d0 0.955664430853978d0))
  ((rgb :prophoto-rgb) (-0.228257890055187d0 0.840405769252342d0 0.9435393927776975d0))
  ((rgb :simple-srgb) (-0.9773097100953217d0 0.9600031839952313d0 0.9698917642989654d0))
  ((rgb :smpte-c-rgb) (-1.0324975617621581d0 0.9771299794914254d0 0.9683956054217155d0))
  ((rgb :srgb) (-12.283818302071468d0 0.9612543329666813d0 0.9708458957869069d0)))

(diag "~&From XYZ (round trip)")
(define-tests/round-trip (xyz)
  xyy
  lab
  lch-ab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From xyY (one way)")
(define-tests/one-way (xyy 0.22882279463372762d0 0.2756865588051985d0 0.49140627521213487d0)
  (xyz (0.4078724682186829d0 0.4914062752121349d0 0.8832030625079514d0))
  (lab (75.53873122580802d0 -23.75916286870483d0 -34.06364765330996d0))
  (lch-ab (75.53873122580802d0 41.53107164124821d0 235.1044884123536d0))
  (luv (75.53873122580802d0 -53.10885770821632d0 -48.701521684779d0))
  (lch-uv (75.53873122580802d0 72.05823326646697d0 222.5212331959971d0))
  ((rgb :adobe-rgb) (0.477759635648462d0 0.7867809784027634d0 0.9641106893604173d0))
  ((rgb :adobe-wide-gamut-rgb) (0.5469066086254852d0 0.7677687419254872d0 0.954371708901213d0))
  ((rgb :apple-rgb) (0.2335480788155702d0 0.7509820969108089d0 0.9713560178573449d0))
  ((rgb :best-rgb) (0.527436142269029d0 0.7596089109968638d0 0.945983001263529d0))
  ((rgb :beta-rgb) (0.5391820159723474d0 0.7773500978142132d0 0.9517896646950188d0))
  ((rgb :bruce-rgb) (0.3590906131068887d0 0.7868479820733549d0 0.963773499899909d0))
  ((rgb :bt2020) (0.5007008228916607d0 0.7449517462801802d0 0.9448078455088786d0))
  ((rgb :bt470-ntsc) (0.5113841187947094d0 0.7666538854631929d0 0.9548854353941129d0))
  ((rgb :bt470-pal/secam) (0.3738271623298213d0 0.8283234225116588d0 0.9785855052736638d0))
  ((rgb :bt709) (0.1603738273161351d0 0.7678213897193806d0 0.9683096929881114d0))
  ((rgb :cie-rgb) (0.3672484332048480d0 0.7740133628418490d0 0.9466453841339852d0))
  ((rgb :colormatch-rgb) (0.3043192555472190d0 0.7506880463113186d0 0.9733446248590530d0))
  ((rgb :dci-p3) (0.4330912324885450d0 0.8068900631098458d0 0.9592018887931189d0))
  ((rgb :dci-p3+) (0.5875624783876848d0 0.8179216554932087d0 0.9505165973837105d0))
  ((rgb :don-rgb-4) (0.5267771037951173d0 0.7734190124829580d0 0.9489116891183200d0))
  ((rgb :eci-rgb-v2) (0.5579177119642573d0 0.8010089372701620d0 0.9637233373757265d0))
  ((rgb :ekta-space-ps5) (0.5069450728143874d0 0.7808046339867004d0 0.9519012856594345d0))
  ((rgb :prophoto-rgb) (0.5562697081271205d0 0.7143778026606519d0 0.9320871940901260d0))
  ((rgb :simple-srgb) (0.2325918013208214d0 0.7868479820733549d0 0.9708774301119986d0))
  ((rgb :smpte-c-rgb) (0.0434774097026900d0 0.7898649815254276d0 0.9694659090756381d0))
  ((rgb :srgb) (0.2220962583913887d0 0.7918745050429686d0 0.9718015078049395d0)))

(diag "~&From xyY (round trip)")
(define-tests/round-trip (xyy)
  xyz
  lab
  lch-ab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From Lab (one way)")
(define-tests/one-way (lab 77.03361122337391d0 -88.2832867107874d0 -52.38837618088325d0)
  (xyz (0.2325367894129148d0 0.5158764104982997d0 1.3114716274697171d0))
  (xyy (0.112888248081606d0 0.2504394438179428d0 0.5158764104982997d0))
  (lch-ab (77.03361122337391d0 102.65710239106122d0 210.68540912469328d0))
  (luv (77.03361122337391d0 -119.87129199995177d0 -78.4531721942953d0))
  (lch-uv (77.03361122337391d0 143.26209154233877d0 213.2038808737796d0))
  ((rgb :adobe-rgb) (-0.5502796755786102d0 0.9019011549416622d0 1.1162614336716492d0))
  ((rgb :adobe-wide-gamut-rgb) (-0.3263149947569894d0 0.8423845154170478d0 1.101225694291733d0))
  ((rgb :apple-rgb) (-0.7531763220661702d0 0.8977066458869535d0 1.1628186949742798d0))
  ((rgb :best-rgb) (-0.4317738260411526d0 0.8305977805715036d0 1.089822909348072d0))
  ((rgb :beta-rgb) (-0.3913513196830801d0 0.8740077481314388d0 1.0969769886518748d0))
  ((rgb :bruce-rgb) (-0.741642669293111d0 0.9019342243011916d0 1.1157973696989494d0))
  ((rgb :bt2020) (-0.5246151043165246d0 0.8367604811789244d0 1.101882403461439d0))
  ((rgb :bt470-ntsc) (-0.4786156475127524d0 0.8711402221571389d0 1.1000210876830037d0))
  ((rgb :bt470-pal/secam) (-0.8481270756444532d0 0.9221047356600448d0 1.0982469230202312d0))
  ((rgb :bt709) (-3.120191927740668d0 0.8932493212393352d0 1.1351995910262929d0))
  ((rgb :cie-rgb) (-0.7115623616417792d0 0.8509509744387163d0 1.090445689530492d0))
  ((rgb :colormatch-rgb) (-0.6763996482174581d0 0.8986628524924409d0 1.1671480204949018d0))
  ((rgb :dci-p3) (-0.7637823264683474d0 0.8939702681041434d0 1.0813320498065844d0))
  ((rgb :dci-p3+) (-0.497171960837437d0 0.8921247431644669d0 1.069590528148333d0))
  ((rgb :don-rgb-4) (-0.4340514970565485d0 0.8640134393869846d0 1.0941990678433564d0))
  ((rgb :eci-rgb-v2) (-1.5794933972972915d0 0.896591085226016d0 1.0869135441598854d0))
  ((rgb :ekta-space-ps5) (-0.5073056290968285d0 0.8755319400441034d0 1.0972392459339544d0))
  ((rgb :prophoto-rgb) (0.2423874319788346d0 0.7967293377039927d0 1.1076500299528618d0))
  ((rgb :simple-srgb) (-0.8466678886605812d0 0.9019342243011919d0 1.1243374392909486d0))
  ((rgb :smpte-c-rgb) (-0.9013694248498753d0 0.9126305048946557d0 1.1221871779016124d0))
  ((rgb :srgb) (-8.958417712535429d0 0.9047602393330232d0 1.1196479977069764d0)))

(diag "~&From Lab (round trip)")
(define-tests/round-trip (lab)
  xyz
  xyy
  lch-ab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From LCHab (one way)")
(define-tests/one-way (lch-ab 15.344287349659623d0 61.88893594294575d0 258.798618249731d0)
  (xyz (0.0141773774614284d0 0.0197288255464867d0 0.2056730271393733d0))
  (xyy (0.0591761541796108d0 0.0823478125977693d0 0.0197288255464867d0))
  (lab (15.344287349659623d0 -12.022421411529812d0 -60.70998085614615d0))
  (luv (15.34428734965962d0 -27.260880909967028d0 -55.21823189088586d0))
  (lch-uv (15.34428734965962d0 61.58091231171433d0 243.7247471151161d0))
  ((rgb :adobe-rgb) (-0.2632138396446138d0 0.2085158037675815d0 0.4882744446633417d0))
  ((rgb :adobe-wide-gamut-rgb) (-0.2262468013486731d0 0.2083457455243176d0 0.478797662768471d0))
  ((rgb :apple-rgb) (-0.247622942466717d0 0.1465749201630559d0 0.4315592169022597d0))
  ((rgb :best-rgb) (-0.2271686633569973d0 0.1883687901021161d0 0.4695506407721215d0))
  ((rgb :beta-rgb) (-0.2184027322395023d0 0.2066234405663671d0 0.4765011767891986d0))
  ((rgb :bruce-rgb) (-0.3042591066890263d0 0.2086319222590547d0 0.4879828351843904d0))
  ((rgb :bt2020) (-0.156555961956939d0 0.112510627368445d0 0.4254463876047152d0))
  ((rgb :bt470-ntsc) (-0.2384914433178642d0 0.1584987195070374d0 0.4806817903514822d0))
  ((rgb :bt470-pal/secam) (-0.4091977721374944d0 0.2918957284282138d0 0.5788537129113679d0))
  ((rgb :bt709) (-0.3912029593991169d0 0.1339081277754479d0 0.4503614481727313d0))
  ((rgb :cie-rgb) (-0.3159101071602394d0 0.2226732403374511d0 0.4704758163732122d0))
  ((rgb :colormatch-rgb) (-0.2242047894755648d0 0.1446272043781323d0 0.4325611481994455d0))
  ((rgb :dci-p3) (-0.3613050612934319d0 0.2540951319610347d0 0.5344969855487135d0))
  ((rgb :dci-p3+) (-0.2654961511792777d0 0.3092979626798522d0 0.5238494831810956d0))
  ((rgb :don-rgb-4) (-0.2275512508087427d0 0.203393437800504d0 0.4725561383512143d0))
  ((rgb :eci-rgb-v2) (-0.3697049338439124d0 0.1698072576887741d0 0.5210722360221204d0))
  ((rgb :ekta-space-ps5) (-0.231370047366999d0 0.218926688079961d0 0.4765518120717788d0))
  ((rgb :prophoto-rgb) (-0.0549707920033401d0 0.1295922930943012d0 0.3947316719518293d0))
  ((rgb :simple-srgb) (-0.3294681691996134d0 0.2086319222590547d0 0.4963850277033493d0))
  ((rgb :smpte-c-rgb) (-0.3455068908415275d0 0.2064742677621276d0 0.4950171471456092d0))
  ((rgb :srgb) (-1.1231871634303534d0 0.195813835284156d0 0.5001618023558022d0)))

(diag "~&From LCHab (round trip)")
(define-tests/round-trip (lch-ab)
  xyz
  xyy
  lab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From Luv (one way)")
(define-tests/one-way (luv 47.986348438762725d0 139.65052589061844d0 -124.97460921556608d0)
  (xyz (0.6001147326277835d0 0.1678371175242143d0 0.8027960034800804d0))
  (xyy (0.3820566943574831d0 0.1068517248876836d0 0.1678371175242143d0))
  (lab (47.98634843876273d0 145.9399852546689d0 -75.55830974201243d0))
  (lch-ab (47.98634843876273d0 164.33970143335074d0 332.6277937488115d0))
  (lch-uv (47.986348438762725d0 187.4057692017771d0 318.17433027866224d0))
  ((rgb :adobe-rgb) (0.9071683821203013d0 -0.519878583578963d0 0.9426836719996199d0))
  ((rgb :adobe-wide-gamut-rgb) (0.8115589048819002d0 -0.1924678890543115d0 0.9280683192276026d0))
  ((rgb :apple-rgb) (1.061924838221104d0 -0.50365408451938d0 0.9793891641323093d0))
  ((rgb :best-rgb) (0.8859065527257592d0 -0.278586302378961d0 0.9057186623984529d0))
  ((rgb :beta-rgb) (0.8745265497894879d0 -0.414022147256472d0 0.9252747871414934d0))
  ((rgb :bruce-rgb) (1.0230586654120395d0 -0.5199993659908473d0 0.9414979115207861d0))
  ((rgb :bt2020) (0.8545328308409006d0 -0.5540575279834123d0 0.9108503949860984d0))
  ((rgb :bt470-ntsc) (0.8995020885206997d0 -0.5720790846795014d0 0.9399395254162966d0))
  ((rgb :bt470-pal/secam) (1.0549480976544494d0 -0.5982178311461979d0 0.9781618772143771d0))
  ((rgb :bt709) (1.1042868444633331d0 -1.0676249261730817d0 0.9627117836233114d0))
  ((rgb :cie-rgb) (0.949830656302994d0 0.0519152695231464d0 0.9091011250200721d0))
  ((rgb :colormatch-rgb) (1.0366034156466544d0 -0.5147891619966637d0 0.9759464879292264d0))
  ((rgb :dci-p3) (1.0129970081961222d0 -0.5199149635524124d0 0.9387592387427478d0))
  ((rgb :dci-p3+) (0.939933800796452d0 0.300764427381701d0 0.9168990084288642d0))
  ((rgb :don-rgb-4) (0.8868748754648104d0 -0.3823849581829863d0 0.9111440695322907d0))
  ((rgb :eci-rgb-v2) (0.9028683322028582d0 -2.3585322478052917d0 0.9553062479904398d0))
  ((rgb :ekta-space-ps5) (0.9412862947778035d0 -0.3515300522591714d0 0.9249270177259638d0))
  ((rgb :prophoto-rgb) (0.8197871353752993d0 -0.2111213289591053d0 0.8798889110662239d0))
  ((rgb :simple-srgb) (1.0958955611120855d0 -0.5199993659908475d0 0.9657339970126865d0))
  ((rgb :smpte-c-rgb) (1.1294360097392313d0 -0.5655441555433881d0 0.963527247946144d0))
  ((rgb :srgb) (1.0923806729967236d0 -3.065269788034714d0 0.9668140105962776d0)))

(diag "~&From Luv (round trip)")
(define-tests/round-trip (luv)
  xyz
  xyy
  lab
  lch-ab
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From LCHuv (one way)")
(define-tests/one-way (lch-uv 97.98024274406411d0 42.98937536590833d0 344.65011946118125d0)
  (xyz (1.1163854349908506d0 0.9486691218359667d0 1.0082636025159788d0))
  (xyy (0.3632508504194634d0 0.3086791124934595d0 0.9486691218359667d0))
  (lab (97.98024274406411d0 27.396068927694305d0 -4.031736367628147d0))
  (lch-ab (97.98024274406411d0 27.69114462836509d0 351.6281718011691d0))
  (luv (97.98024274406411d0 41.45582958474809d0 -11.379832502778369d0))
  ((rgb :adobe-rgb) (1.1102960980210306d0 0.8952899553665923d0 1.0080950281544108d0))
  ((rgb :adobe-wide-gamut-rgb) (1.0774311207132528d0 0.9348150494390668d0 1.0071788469059115d0))
  ((rgb :apple-rgb) (1.2061907563394791d0 0.8613695225652167d0 1.0194885585041937d0))
  ((rgb :best-rgb) (1.0979866535021654d0 0.9319404366333733d0 1.0036601505249125d0))
  ((rgb :beta-rgb) (1.0934085558635565d0 0.9134687740855695d0 1.0072483450082292d0))
  ((rgb :bruce-rgb) (1.1537441643250745d0 0.89532512150811d0 1.0078591469386724d0))
  ((rgb :bt2020) (1.0989053693758923d0 0.9130897003369753d0 1.0065761456791278d0))
  ((rgb :bt470-ntsc) (1.103712714999937d0 0.8923551537105596d0 1.0104399888747904d0))
  ((rgb :bt470-pal/secam) (1.1333589654247325d0 0.9167915573401402d0 1.010906633159173d0))
  ((rgb :bt709) (1.1991276505333444d0 0.8860508612353085d0 1.0137074535490302d0))
  ((rgb :cie-rgb) (1.1335047519950059d0 0.937467523883523d0 1.0043883572110786d0))
  ((rgb :colormatch-rgb) (1.1911878975968702d0 0.8591386555859246d0 1.0177341737798553d0))
  ((rgb :dci-p3) (1.1259163253799451d0 0.9212255114993801d0 1.006750010623547d0))
  ((rgb :dci-p3+) (1.0906785208636276d0 0.9488647591576411d0 1.0035412012198437d0))
  ((rgb :don-rgb-4) (1.098323804310209d0 0.9183383809126603d0 1.0041979039120954d0))
  ((rgb :eci-rgb-v2) (1.0835944774464357d0 0.9097641603836656d0 1.0100461238191485d0))
  ((rgb :ekta-space-ps5) (1.1149605932821878d0 0.919405597292578d0 1.0071106687954725d0))
  ((rgb :prophoto-rgb) (1.0909661592667503d0 0.9173802717307229d0 1.0035066252996514d0))
  ((rgb :simple-srgb) (1.183178339213763d0 0.89532512150811d0 1.0125994370401443d0))
  ((rgb :smpte-c-rgb) (1.1982782954758215d0 0.8863912634285516d0 1.012424429953509d0))
  ((rgb :srgb) (1.1758784052557045d0 0.8983115008666079d0 1.012178337800396d0)))

(diag "~&From LCHuv (round trip)")
(define-tests/round-trip (lch-uv)
  xyz
  xyy
  lab
  lch-ab
  luv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From RGB (Adobe RGB) (one way)")
(define-tests/one-way (rgb 0.4253890484849989d0 0.9421761686631593d0 0.11923785445407287d0
                           :space :adobe-rgb)
  (xyz (0.2525439766564273d0 0.5964320958261923d0 0.0753622386175564d0))
  (xyy (0.2732159574299605d0 0.6452530298309288d0 0.5964320958261923d0))
  (lab (81.64387167019585d0 -99.43189896636085d0 86.23725225796892d0))
  (lch-ab (81.64387167019585d0 131.61901917679359d0 139.06491190370332d0))
  (luv (81.64387167019585d0 -96.21349096356381d0 107.40891719432494d0))
  (lch-uv (81.64387167019585d0 144.20024735156707d0 131.85297167458134d0))
  ((rgb :adobe-wide-gamut-rgb) (0.55506328409504d0 0.8640110487601457d0 0.2144188645274893d0))
  ((rgb :apple-rgb) (-0.208285651516117d0 0.9525019002786511d0 -0.2034182719298832d0))
  ((rgb :best-rgb) (0.4552836978999552d0 0.8782162556660119d0 0.2963519780044409d0))
  ((rgb :beta-rgb) (0.4717482791396977d0 0.9085922392306959d0 0.2280485970443202d0))
  ((rgb :bruce-rgb) (-0.1563730752638756d0 0.9421960974410715d0 0.1299516113085057d0))
  ((rgb :bt2020) (0.4364258794240565d0 0.8932857643142468d0 0.1863280929658141d0))
  ((rgb :bt470-ntsc) (0.434467064011132d0 0.9639444856951203d0 0.1522642404356368d0))
  ((rgb :bt470-pal/secam) (-0.4286300916367691d0 0.954294565975196d0 -0.3132298067822969d0))
  ((rgb :bt709) (-0.6121577649455804d0 0.9370902348072052d0 -0.1258124182647374d0))
  ((rgb :cie-rgb) (0.3509230717795801d0 0.8519791520109288d0 0.2862142557701493d0))
  ((rgb :colormatch-rgb) (-0.1421335664263123d0 0.9575200854116652d0 -0.1951985575435977d0))
  ((rgb :dci-p3) (-0.1315272133146917d0 0.9346811212693403d0 0.2740579665498048d0))
  ((rgb :dci-p3+) (0.4326345990430717d0 0.8565182524783166d0 0.3683379341363698d0))
  ((rgb :don-rgb-4) (0.4537831860478359d0 0.9002421115907301d0 0.2788446151300183d0))
  ((rgb :eci-rgb-v2) (0.4896959451242547d0 0.9589651980639323d0 0.0289436105083099d0))
  ((rgb :ekta-space-ps5) (0.3489857181948631d0 0.8916327422985367d0 0.2293496272539474d0))
  ((rgb :prophoto-rgb) (0.4242569386479385d0 0.8535984485941335d0 0.2401834685078588d0))
  ((rgb :simple-srgb) (-0.4038359067983986d0 0.9421960974410715d0 -0.1967291133853854d0))
  ((rgb :smpte-c-rgb) (-0.4737065124141337d0 0.9591172922514462d0 -0.1840265135774567d0))
  ((rgb :srgb) (-1.7575729606881998d0 0.9439612733133196d0 -0.361221431995646d0)))

(diag "~&From RGB (Adobe RGB) (round trip)")
(define-tests/round-trip (rgb :adobe-rgb)
  xyz
  xyy
  lab
  lch-ab
  luv
  lch-uv
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From RGB (Adobe Wide Gamut RGB) (one way)")
(define-tests/one-way (rgb 0.3639436099253135d0 0.08486258678927672d0 0.14289086780800808d0
                           :space :adobe-wide-gamut-rgb)
  (xyz (0.0800630380549832d0 0.0314383010133982d0 0.0109506098598647d0))
  (xyy (0.6538322889568562d0 0.2567398991078559d0 0.0314383010133982d0))
  (lab (20.61095114048863d0 60.32808515366439d0 15.771773771209318d0))
  (lch-ab (20.61095114048863d0 62.35564694715298d0 14.651114427876756d0))
  (luv (20.61095114048863d0 90.76780156957258d0 -1.068183009272207d0))
  (lch-uv (20.61095114048863d0 90.77408670272922d0 359.3257570196789d0))
  ((rgb :adobe-rgb) (0.401212590292516d0 -0.1599410154697203d0 0.1370645185941288d0))
  ((rgb :apple-rgb) (0.3861358100847623d0 -0.1237725079448818d0 0.096249331425148d0))
  ((rgb :best-rgb) (0.3851292916309612d0 0.0817000175016046d0 0.140721469437329d0))
  ((rgb :beta-rgb) (0.3795991161040187d0 -0.1087595085098683d0 0.1452923643296395d0))
  ((rgb :bruce-rgb) (0.4465796454648012d0 -0.1600451558623416d0 0.1368290455740325d0))
  ((rgb :bt2020) (0.3193719567466659d0 -0.0122121931450139d0 0.0635518420949752d0))
  ((rgb :bt470-ntsc) (0.3920477139131869d0 -0.1544267398373566d0 0.1508345237110902d0))
  ((rgb :bt470-pal/secam) (0.5481676638049032d0 -0.2370074462535237d0 0.2195330712623187d0))
  ((rgb :bt709) (0.4273063462509777d0 -0.0798998728191218d0 0.0627750983408815d0))
  ((rgb :cie-rgb) (0.4300250452469282d0 0.0891735432086958d0 0.1420882770488356d0))
  ((rgb :colormatch-rgb) (0.3721702887471786d0 -0.1262793750190167d0 0.092215320789217d0))
  ((rgb :dci-p3) (0.5022542758675556d0 -0.172077207051061d0 0.1974504522662238d0))
  ((rgb :dci-p3+) (0.453889133669352d0 0.1208326312741326d0 0.1957218135712694d0))
  ((rgb :don-rgb-4) (0.3855067669126432d0 -0.0869565749334066d0 0.1397000230051457d0))
  ((rgb :eci-rgb-v2) (0.4187043859291697d0 -0.1434068913412768d0 0.1315766073597695d0))
  ((rgb :ekta-space-ps5) (0.4022061688335193d0 -0.0909636068733093d0 0.1448499317116877d0))
  ((rgb :prophoto-rgb) (0.2769638177580763d0 0.0467759649617503d0 0.0906063165957486d0))
  ((rgb :simple-srgb) (0.4753472925568803d0 -0.1600451558623416d0 0.1434250298931951d0))
  ((rgb :smpte-c-rgb) (0.4901340932087668d0 -0.1780807560949065d0 0.144147954391313d0))
  ((rgb :srgb) (0.4785550468522818d0 -0.2294014126273451d0 0.1228929196332381d0)))

(diag "~&From RGB (Adobe Wide Gamut RGB) (round trip)")
(define-tests/round-trip (rgb :adobe-wide-gamut-rgb)
  xyz
  xyy
  lab
  lch-ab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From RGB (Apple RGB) (one way)")
(define-tests/one-way (rgb 0.04330031119736d0 0.1934597870725685d0 0.636296334766828d0
                           :space :apple-rgb)
  (xyz (0.0997907667105796d0 0.0727239043095458d0 0.4162813669652056d0))
  (xyy (0.1694827415144151d0 0.1235128968570905d0 0.0727239043095458d0))
  (lab (32.41913777434424d0 27.178185655687304d0 -61.672923887047126d0))
  (lch-ab (32.41913777434424d0 67.39587017252997d0 293.78225368971755d0))
  (luv (32.41913777434424d0 -14.415258103958493d0 -84.30347709901454d0))
  (lch-uv (32.41913777434424d0 85.52704786900932d0 260.2966977457586d0))
  ((rgb :adobe-rgb) (0.1654836693171074d0 0.2718316687197496d0 0.6706771076848413d0))
  ((rgb :adobe-wide-gamut-rgb) (0.1924146731692412d0 0.3079463031786109d0 0.6590731410952287d0))
  ((rgb :best-rgb) (0.225474199487315d0 0.2837725012996739d0 0.6466935845427964d0))
  ((rgb :beta-rgb) (0.2332800784545396d0 0.286711862280749d0 0.6563278227025818d0))
  ((rgb :bruce-rgb) (0.1248383826877425d0 0.2719574365813021d0 0.6701897294616318d0))
  ((rgb :bt2020) (0.1590905850939759d0 0.2051989452379542d0 0.6211470982562745d0))
  ((rgb :bt470-ntsc) (0.2135070132269705d0 0.2048634895017481d0 0.6625102389008891d0))
  ((rgb :bt470-pal/secam) (0.163569431590282d0 0.3594837878535465d0 0.7429810141674233d0))
  ((rgb :bt709) (0.0182341853636832d0 0.2037984320551895d0 0.6533431068147283d0))
  ((rgb :cie-rgb) (-0.1377928683337266d0 0.3258769884241275d0 0.6480752725229747d0))
  ((rgb :colormatch-rgb) (0.1118272594561575d0 0.189015031566681d0 0.6369832547143264d0))
  ((rgb :dci-p3) (0.1821573598245372d0 0.3312285003831767d0 0.7010003581979936d0))
  ((rgb :dci-p3+) (0.3275200727062474d0 0.419389164663676d0 0.6876615815390275d0))
  ((rgb :don-rgb-4) (0.2253235546014556d0 0.2874960478808469d0 0.6504666331794392d0))
  ((rgb :eci-rgb-v2) (0.2164208161139321d0 0.242227397227215d0 0.7016673358053483d0))
  ((rgb :ekta-space-ps5) (0.2436417281786436d0 0.3064066479531024d0 0.6563345343654035d0))
  ((rgb :prophoto-rgb) (0.2484058007620153d0 0.2139740753621915d0 0.5838384628377971d0))
  ((rgb :simple-srgb) (0.0817671806545912d0 0.2719574365813021d0 0.6819551475619481d0))
  ((rgb :smpte-c-rgb) (-0.0728074878241107d0 0.2603568479459183d0 0.6802644291442433d0))
  ((rgb :srgb) (0.0512795967223595d0 0.2647998975882512d0 0.6877829971587036d0)))

(diag "~&From RGB (Apple RGB) (round trip)")
(define-tests/round-trip (rgb :apple-rgb)
  xyz
  xyy
  lab
  lch-ab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From RGB (Best RGB) (one way)")
(define-tests/one-way (rgb 0.6350939101110611d0 0.4448792502629473d0 0.2997304869722377d0
                           :space :best-rgb)
  (xyz (0.2764290244005207d0 0.2106726291896849d0 0.0591884553847105d0))
  (xyy (0.506011402840928d0 0.3856424008573041d0 0.2106726291896849d0))
  (lab (53.02303118387675d0 32.177895650678636d0 35.90708402257808d0))
  (lch-ab (53.02303118387675d0 48.215512560901445d0 48.135103666497386d0))
  (luv (53.02303118387675d0 66.71542638055483d0 25.19652032043792d0))
  (lch-uv (53.02303118387675d0 71.31488451506792d0 20.69012566226302d0))
  ((rgb :adobe-rgb) (0.6544852703215968d0 0.4024409626803758d0 0.2742571375299723d0))
  ((rgb :adobe-wide-gamut-rgb) (0.6197880097229231d0 0.440182589858155d0 0.2897310773980831d0))
  ((rgb :apple-rgb) (0.6602446976666017d0 0.3191176035565234d0 0.1931353666076857d0))
  ((rgb :beta-rgb) (0.6293993162754736d0 0.4209431284662767d0 0.2941011473074329d0))
  ((rgb :bruce-rgb) (0.698519733958685d0 0.4025710634385055d0 0.2747483944035031d0))
  ((rgb :bt2020) (0.5936302283795212d0 0.3816570433414624d0 0.2312605664791904d0))
  ((rgb :bt470-ntsc) (0.642412228503407d0 0.4177547662943373d0 0.2922910841188601d0))
  ((rgb :bt470-pal/secam) (0.7702170897737974d0 0.4892368375870653d0 0.3522858960735692d0))
  ((rgb :bt709) (0.7030959469128413d0 0.347469526491615d0 0.1985306550857365d0))
  ((rgb :cie-rgb) (0.6888334798442167d0 0.4370538214226883d0 0.2994015876945799d0))
  ((rgb :colormatch-rgb) (0.6412415320459589d0 0.3182424358571522d0 0.1888021884393076d0))
  ((rgb :dci-p3) (0.7348993878997603d0 0.4787098985606398d0 0.3554793099815532d0))
  ((rgb :dci-p3+) (0.6832777400696521d0 0.4866248258153854d0 0.3677486484949327d0))
  ((rgb :don-rgb-4) (0.6354435566500226d0 0.4268327687698423d0 0.2956847744369947d0))
  ((rgb :eci-rgb-v2) (0.6744077581358262d0 0.447333022974278d0 0.30711237864015d0))
  ((rgb :ekta-space-ps5) (0.648516255478045d0 0.4215048381386043d0 0.2937889548033163d0))
  ((rgb :prophoto-rgb) (0.5265336676950015d0 0.3716995964773097d0 0.2313496593452214d0))
  ((rgb :simple-srgb) (0.7275236242919559d0 0.4025710634385055d0 0.2671788317228748d0))
  ((rgb :smpte-c-rgb) (0.7435832226272032d0 0.3946829811393335d0 0.269548661945066d0))
  ((rgb :srgb) (0.7331562097755134d0 0.4031680509157458d0 0.2596451213286143d0)))

(diag "~&From RGB (Best RGB) (round trip)")
(define-tests/round-trip (rgb :best-rgb)
  xyz
  xyy
  lab
  lch-ab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From RGB (Beta RGB) (one way)")
(define-tests/one-way (rgb 0.31921045514906754d0 0.037190376334251374d0 0.945948736397938d0
                           :space :beta-rgb)
  (xyz (0.1593144262373026d0 0.054217555686869d0 0.6942450070589394d0))
  (xyy (0.1754995204447363d0 0.0597256334373526d0 0.054217555686869d0))
  (lab (27.904055021814735d0 85.12474349785842d0 -113.10969061237684d0))
  (lch-ab (27.904055021814735d0 141.56279195467923d0 306.96459835848066d0))
  (luv (27.904055021814735d0 -0.2123948091575568d0 -119.1161245799626d0))
  (lch-uv (27.904055021814735d0 119.11631393937661d0 269.89783655822373d0))
  ((rgb :adobe-rgb) (0.2380250502100414d0 -0.1993438304959273d0 0.9691174080191522d0))
  ((rgb :adobe-wide-gamut-rgb) (0.2125155221753397d0 0.237858858879798d0 0.9504112271325325d0))
  ((rgb :apple-rgb) (0.1967413104684128d0 -0.1850079596156339d0 1.0042747441071302d0))
  ((rgb :best-rgb) (0.3132032264734757d0 0.1231380725495632d0 0.929293879981428d0))
  ((rgb :bruce-rgb) (0.2768056045484173d0 -0.1994580274723692d0 0.968122489687564d0))
  ((rgb :bt2020) (0.2482095147416419d0 -0.0473481421573035d0 0.9340431891530903d0))
  ((rgb :bt470-ntsc) (0.3027584725773753d0 -0.3443349954304877d0 0.956925117444361d0))
  ((rgb :bt470-pal/secam) (0.3804147848894465d0 -0.2817625940538132d0 0.9952034016918101d0))
  ((rgb :bt709) (0.2352495970154405d0 -0.1296838386961163d0 0.9873744160904552d0))
  ((rgb :cie-rgb) (-0.1506319981669584d0 0.2958556999078188d0 0.9317682212001562d0))
  ((rgb :colormatch-rgb) (0.2488304539833793d0 -0.1984817315409355d0 1.004832517352424d0))
  ((rgb :dci-p3) (0.339729747974847d0 -0.229236098493325d0 0.9554211443426873d0))
  ((rgb :dci-p3+) (0.4543367077368962d0 0.4401284891374271d0 0.9341596559267598d0))
  ((rgb :don-rgb-4) (0.3134799855902734d0 0.0900138333228997d0 0.9354982826520005d0))
  ((rgb :eci-rgb-v2) (0.318787513618165d0 -0.5996328871179669d0 0.9692747778693053d0))
  ((rgb :ekta-space-ps5) (0.366102962852163d0 0.2017949891408407d0 0.9459079383065938d0))
  ((rgb :prophoto-rgb) (0.3676177272940101d0 0.0742026605326733d0 0.9084707573313952d0))
  ((rgb :simple-srgb) (0.3005050101041382d0 -0.1994580274723693d0 0.9883963855461455d0))
  ((rgb :smpte-c-rgb) (0.2937086093246061d0 -0.2504733347408447d0 0.9856706045848207d0))
  ((rgb :srgb) (0.2954423093749218d0 -0.3723367102119606d0 0.9887728894896194d0)))

(diag "~&From RGB (Beta RGB) (round trip)")
(define-tests/round-trip (rgb :beta-rgb)
  xyz
  xyy
  lab
  lch-ab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From RGB (Bruce RGB) (one way)")
(define-tests/one-way (rgb 0.2979828292665525d0 0.6006607749291795d0 0.9075950974778275d0
                           :space :bruce-rgb)
  (xyz (0.2809016442314912d0 0.3004759241082804d0 0.8280719105913972d0))
  (xyy (0.1992988386107376d0 0.2131867290029728d0 0.3004759241082804d0))
  (lab (61.69526442104498d0 -1.8391610392906044d0 -48.59605960773949d0))
  (lch-ab (61.69526442104498d0 48.63084949625509d0 267.83262472411974d0))
  (luv (61.69526442104498d0 -34.747141059184756d0 -77.37194388690675d0))
  (lch-uv (61.69526442104498d0 84.81616303880723d0 245.81552070689162d0))
  ((rgb :adobe-rgb) (0.3787913275579068d0 0.6005520203792374d0 0.9081098640031473d0))
  ((rgb :adobe-wide-gamut-rgb) (0.4285952644270877d0 0.603427679431649d0 0.8959411195391064d0))
  ((rgb :apple-rgb) (0.1878148933519053d0 0.534834436396165d0 0.911664752339521d0))
  ((rgb :best-rgb) (0.4306039826577839d0 0.5888089509011318d0 0.8838925964985361d0))
  ((rgb :beta-rgb) (0.4405589865587527d0 0.6005081535690553d0 0.8928976825793102d0))
  ((rgb :bt2020) (0.3902135654168072d0 0.5512041869039294d0 0.8793931986056982d0))
  ((rgb :bt470-ntsc) (0.4165148421520295d0 0.5666098458732474d0 0.8983910098976206d0))
  ((rgb :bt470-pal/secam) (0.337590509430744d0 0.6699861987272204d0 0.9379248820938909d0))
  ((rgb :bt709) (0.1458731862396332d0 0.5644996097421988d0 0.9114570283720871d0))
  ((rgb :cie-rgb) (0.2569297496064074d0 0.6147762843113039d0 0.8851019607154464d0))
  ((rgb :colormatch-rgb) (0.252078943011784d0 0.532823157284757d0 0.9130650702519695d0))
  ((rgb :dci-p3) (0.3691998727172094d0 0.6433310234913652d0 0.909130195427883d0))
  ((rgb :dci-p3+) (0.512108680913662d0 0.6834622543599513d0 0.8967210689571024d0))
  ((rgb :don-rgb-4) (0.430171143600685d0 0.5984730572898519d0 0.8877266660917404d0))
  ((rgb :eci-rgb-v2) (0.4562366985871081d0 0.6182430265717983d0 0.9158542337620393d0))
  ((rgb :ekta-space-ps5) (0.4276880866635887d0 0.610433277461558d0 0.8929547484349345d0))
  ((rgb :prophoto-rgb) (0.455724655303097d0 0.5230737701637732d0 0.8567200794658008d0))
  ((rgb :simple-srgb) (0.2194608772690253d0 0.6006607749291796d0 0.9186533716918835d0))
  ((rgb :smpte-c-rgb) (0.1316695924236051d0 0.5983674943912592d0 0.9168797691550581d0))
  ((rgb :srgb) (0.2077220220198269d0 0.6061945913744511d0 0.9210562053721705d0)))

(diag "~&From RGB (Bruce RGB) (round trip)")
(define-tests/round-trip (rgb :bruce-rgb)
  xyz
  xyy
  lab
  lch-ab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From RGB (bt.2020) (one way)")
(define-tests/one-way (rgb 0.8647825663753892d0 0.650627618712821d0 0.16693964666756922d0
                           :space :bt2020)
  (xyz (0.544787930311322d0 0.4884956722603613d0 0.0573156133972909d0))
  (xyy (0.4995308288639191d0 0.4479149307166366d0 0.4884956722603613d0))
  (lab (75.35764503801688d0 21.55919683171398d0 82.5597384185243d0))
  (lch-ab (75.35764503801688d0 85.32824488856984d0 75.3649139524816d0))
  (luv (75.35764503801688d0 71.58183030240309d0 76.61631556656096d0))
  (lch-uv (75.35764503801688d0 104.85236401930518d0 46.94566449535839d0))
  ((rgb :adobe-rgb) (0.9119248796353822d0 0.6522745935583497d0 0.1093330198833884d0))
  ((rgb :adobe-wide-gamut-rgb) (0.8734070347987483d0 0.6760462538369851d0 0.2052032348403634d0))
  ((rgb :apple-rgb) (0.9725192270991155d0 0.5871495367356673d0 -0.1215575138398996d0))
  ((rgb :best-rgb) (0.8847118386478522d0 0.6869216619324597d0 0.2575768550592596d0))
  ((rgb :beta-rgb) (0.8776838648355374d0 0.6645700239112308d0 0.2228612664210574d0))
  ((rgb :bruce-rgb) (0.9609300184879218d0 0.6523735748541811d0 0.1147452288787211d0))
  ((rgb :bt470-ntsc) (0.8939288961219634d0 0.6798759317540958d0 0.2009237784760273d0))
  ((rgb :bt470-pal/secam) (0.985876004805991d0 0.7149030351475856d0 -0.2150510278085332d0))
  ((rgb :bt709) (0.993083470459128d0 0.6210275102555027d0 -0.0394009385177799d0))
  ((rgb :cie-rgb) (0.9589658774812101d0 0.6678009863595815d0 0.2538548460102724d0))
  ((rgb :colormatch-rgb) (0.9443375198442624d0 0.5876614560818048d0 -0.1326317721504476d0))
  ((rgb :dci-p3) (0.9630823661754571d0 0.709593298658005d0 0.2793822478011023d0))
  ((rgb :dci-p3+) (0.8979836519653752d0 0.6922827352718657d0 0.339416771510501d0))
  ((rgb :don-rgb-4) (0.885094774061977d0 0.6696175919048165d0 0.2411042969674344d0))
  ((rgb :eci-rgb-v2) (0.904289432661375d0 0.7052494032883333d0 0.1689411578940924d0))
  ((rgb :ekta-space-ps5) (0.8959467426551526d0 0.6595243269881145d0 0.222172354174367d0))
  ((rgb :prophoto-rgb) (0.7869434842066114d0 0.6321856701084052d0 0.1997105707757638d0))
  ((rgb :simple-srgb) (0.9936431565524005d0 0.6523735748541812d0 -0.1160590776955922d0))
  ((rgb :smpte-c-rgb) (1.0130682245598304d0 0.6485621186665907d0 -0.0929238849028941d0))
  ((rgb :srgb) (0.9938507705942284d0 0.6581936329219632d0 -0.1131244723666036d0)))

(diag "~&From RGB (bt.2020) (round trip)")
(define-tests/round-trip (rgb :bt2020)
  xyz
  xyy
  lab
  lch-ab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From RGB (bt.470 NTSC) (one way)")
(define-tests/one-way (rgb 0.2663412823714957d0 0.3467776431121068d0 0.7818752452897231d0
                           :space :bt470-ntsc)
  (xyz (0.1665128225170931d0 0.1399745805417191d0 0.6560006934647666d0))
  (xyy (0.1730024746472424d0 0.1454299341958564d0 0.1399745805417191d0))
  (lab (44.22928591202958d0 17.259132890587615d0 -60.50338225276264d0))
  (lch-ab (44.22928591202958d0 62.91690497917771d0 285.9212745525432d0))
  (luv (44.22928591202958d0 -25.059046364194185d0 -93.93003522881666d0))
  (lch-uv (44.22928591202958d0 97.21526280769689d0 255.06229759768576d0))
  ((rgb :adobe-rgb) (0.2127736407833293d0 0.3992629570865384d0 0.7913624338426983d0))
  ((rgb :adobe-wide-gamut-rgb) (0.2598849925224914d0 0.4212919827544117d0 0.7785244378080216d0))
  ((rgb :apple-rgb) (-0.0352481843253329d0 0.319022075363444d0 0.7762328145181168d0))
  ((rgb :best-rgb) (0.2818989764680994d0 0.3998430830452255d0 0.765166922941704d0))
  ((rgb :beta-rgb) (0.2923305094035454d0 0.4075096651099243d0 0.7754106694027016d0))
  ((rgb :bruce-rgb) (0.1232096684491756d0 0.3993931549121634d0 0.7908085443818803d0))
  ((rgb :bt2020) (0.2254674935539107d0 0.3377632360131866d0 0.7508496497908467d0))
  ((rgb :bt470-pal/secam) (-0.0665643048350941d0 0.4861997943055588d0 0.8447400284061476d0))
  ((rgb :bt709) (-0.0286963069632855d0 0.3439801884861333d0 0.785801654817424d0))
  ((rgb :cie-rgb) (-0.1533442134487462d0 0.4375988801048187d0 0.7666046823585335d0))
  ((rgb :colormatch-rgb) (0.1210558555563694d0 0.315480554680878d0 0.7772513038552522d0))
  ((rgb :dci-p3) (0.1888582569680197d0 0.4558860246303746d0 0.8070780823380012d0))
  ((rgb :dci-p3+) (0.3831902993089686d0 0.5263426066791261d0 0.7930509239234604d0))
  ((rgb :don-rgb-4) (0.2815678194202645d0 0.4069130495863348d0 0.7692962528853401d0))
  ((rgb :eci-rgb-v2) (0.2849477954170672d0 0.3989305108261461d0 0.8125602249122817d0))
  ((rgb :ekta-space-ps5) (0.2926794367637593d0 0.4238661469960385d0 0.7754371683649722d0))
  ((rgb :prophoto-rgb) (0.3181760565159d0 0.3256667425869128d0 0.7174641629605231d0))
  ((rgb :simple-srgb) (-0.1004840297520557d0 0.3993931549121634d0 0.8033359562529585d0))
  ((rgb :smpte-c-rgb) (-0.1701355956636326d0 0.391953494059468d0 0.8014660257835224d0))
  ((rgb :srgb) (-0.0823902857701441d0 0.3998515638295023d0 0.8081273896782726d0)))

(diag "~&From RGB (bt.470 NTSC) (round trip)")
(define-tests/round-trip (rgb :bt470-ntsc)
  xyz
  xyy
  lab
  lch-ab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From RGB (bt.470 PAL/SECAM) (one way)")
(define-tests/one-way (rgb 0.6627590075342125d0 0.6067289323633251d0 0.12094238058477136d0
                           :space :bt470-pal/secam)
  (xyz (0.2208730910855624d0 0.2447847706565653d0 0.0408913743869446d0))
  (xyy (0.4360347925374866d0 0.4832398377049223d0 0.2447847706565653d0))
  (lab (56.563705836600406d0 -5.369459817351152d0 58.13507658853677d0))
  (lch-ab (56.563705836600406d0 58.38251646413663d0 95.27696940416735d0))
  (luv (56.563705836600406d0 16.325016964779838d0 59.07064359096619d0))
  (lch-uv (56.563705836600406d0 61.2849664530487d0 74.55110146664974d0))
  ((rgb :adobe-rgb) (0.5771302712267311d0 0.5293139375737439d0 0.1504061797519941d0))
  ((rgb :adobe-wide-gamut-rgb) (0.5686879222062183d0 0.521455920241898d0 0.1904040189481528d0))
  ((rgb :apple-rgb) (0.5281779912552812d0 0.4620821696131528d0 -0.0355285026507295d0))
  ((rgb :best-rgb) (0.5644790546648852d0 0.5295695840879519d0 0.2230003705139497d0))
  ((rgb :beta-rgb) (0.5621148318745645d0 0.5266432060474833d0 0.1988880527273332d0))
  ((rgb :bruce-rgb) (0.5877585330756152d0 0.5294335304629284d0 0.1527455180873991d0))
  ((rgb :bt2020) (0.5224841602634971d0 0.488961358045674d0 0.134368101497022d0))
  ((rgb :bt470-ntsc) (0.5677879659986663d0 0.5463596749474267d0 0.1814587665581844d0))
  ((rgb :bt709) (0.5583290156660449d0 0.4865594859819677d0 0.0251040982799726d0))
  ((rgb :cie-rgb) (0.598682763936607d0 0.5151492037404757d0 0.2198346164704335d0))
  ((rgb :colormatch-rgb) (0.5164914303249177d0 0.4633749487795497d0 -0.0412716763448816d0))
  ((rgb :dci-p3) (0.6365656988570983d0 0.5853202326914799d0 0.2527150295611496d0))
  ((rgb :dci-p3+) (0.6076725213959524d0 0.5579468665533652d0 0.2918849505940641d0))
  ((rgb :don-rgb-4) (0.5645540599354553d0 0.5269018422438602d0 0.213694261362894d0))
  ((rgb :eci-rgb-v2) (0.6050183742518117d0 0.5777646428742401d0 0.153453517544569d0))
  ((rgb :ekta-space-ps5) (0.5622390551016282d0 0.5204967292452476d0 0.1988162214371023d0))
  ((rgb :prophoto-rgb) (0.4641486707773365d0 0.4599874973532655d0 0.1655210713144263d0))
  ((rgb :simple-srgb) (0.5950184262405357d0 0.5294335304629285d0 0.0945575943748159d0))
  ((rgb :smpte-c-rgb) (0.6010281860333871d0 0.5319766505373604d0 0.1058831601180057d0))
  ((rgb :srgb) (0.6004989595358957d0 0.5339516130828247d0 0.0664248306914491d0)))

(diag "~&From RGB (bt.470 PAL/SECAM) (round trip)")
(define-tests/round-trip (rgb :bt470-pal/secam)
  xyz
  xyy
  lab
  lch-ab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From RGB (bt.709) (one way)")
(define-tests/one-way (rgb 0.7985161381714834d0 0.05375185865075549d0 0.8335987255850648d0
                           :space :bt709)
  (xyz (0.3924934932668753d0 0.1942334348528404d0 0.6735956413890881d0))
  (xyy (0.3114230457841005d0 0.1541140653606962d0 0.1942334348528404d0))
  (lab (51.178863546447516d0 82.77705314834954d0 -54.58644629221672d0))
  (lch-ab (51.178863546447516d0 99.15503339083571d0 326.5975704291838d0))
  (luv (51.178863546447516d0 64.47182255669627d0 -93.25206309714073d0))
  (lch-uv (51.178863546447516d0 113.36914560697389d0 304.65887867718646d0))
  ((rgb :adobe-rgb) (0.702065820016383d0 0.1335613709899451d0 0.8313713351506133d0))
  ((rgb :adobe-wide-gamut-rgb) (0.6477117944497696d0 0.3717733897938218d0 0.8198689201031336d0))
  ((rgb :apple-rgb) (0.7451699613325533d0 -0.0938849759748094d0 0.8307698518329859d0))
  ((rgb :best-rgb) (0.6951395170255001d0 0.3399685886195125d0 0.8041755693538291d0))
  ((rgb :beta-rgb) (0.6893089074054359d0 0.271144536168081d0 0.8175067668402477d0))
  ((rgb :bruce-rgb) (0.7708147439726377d0 0.1336568898517486d0 0.8306039204164832d0))
  ((rgb :bt2020) (0.6558847526040437d0 0.2175712329065792d0 0.7957960303918452d0))
  ((rgb :bt470-ntsc) (0.7019303564599807d0 -0.1848742111562074d0 0.8271841885238844d0))
  ((rgb :bt470-pal/secam) (0.8387579902047664d0 0.2057211382821511d0 0.8814940217391181d0))
  ((rgb :cie-rgb) (0.7186125742052109d0 0.3961026731225948d0 0.8063806882445033d0))
  ((rgb :colormatch-rgb) (0.7352523360628505d0 -0.1146809788659653d0 0.8292713997740416d0))
  ((rgb :dci-p3) (0.7984949970258962d0 0.2785621744126153d0 0.8447330837936613d0))
  ((rgb :dci-p3+) (0.7628966340325708d0 0.4916954216509626d0 0.8288966014333266d0))
  ((rgb :don-rgb-4) (0.6956980922773276d0 0.2927757336256869d0 0.808243356629886d0))
  ((rgb :eci-rgb-v2) (0.7283695938670461d0 -0.0490304677858626d0 0.8542570491350784d0))
  ((rgb :ekta-space-ps5) (0.7304096817877608d0 0.3179582287305309d0 0.8173297432178266d0))
  ((rgb :prophoto-rgb) (0.6329668747149282d0 0.2667840839046945d0 0.761978584915094d0))
  ((rgb :simple-srgb) (0.8149972348748125d0 0.1336568898517486d0 0.847182340171176d0))
  ((rgb :smpte-c-rgb) (0.8345268286784181d0 -0.1326707719862288d0 0.8454586856143063d0))
  ((rgb :srgb) (0.8196055930302776d0 0.111754616042607d0 0.8512150684043609d0)))

(diag "~&From RGB (bt.709) (round trip)")
(define-tests/round-trip (rgb :bt709)
  xyz
  xyy
  lab
  lch-ab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From RGB (CIE RGB) (one way)")
(define-tests/one-way (rgb 0.31371992189283615d0 0.2559466505276866d0 0.5839679952923835d0
                           :space :cie-rgb)
  (xyz (0.1149655022555951d0 0.0576037201157763d0 0.303681049267886d0))
  (xyy (0.2413972423782203d0 0.120952624168599d0 0.0576037201157763d0))
  (lab (28.799671871572755d0 50.02085706299214d0 -57.191155342843345d0))
  (lch-ab (28.799671871572755d0 75.97969722738786d0 311.1737781949945d0))
  (luv (28.799671871572755d0 12.272175295309388d0 -74.65081610041774d0))
  (lch-uv (28.799671871572755d0 75.65282962941433d0 279.33560249718806d0))
  ((rgb :adobe-rgb) (0.332366025894677d0 0.1247793506912742d0 0.6046425792668071d0))
  ((rgb :adobe-wide-gamut-rgb) (0.310235431383059d0 0.234792522992223d0 0.5944402901744703d0))
  ((rgb :apple-rgb) (0.292040860870308d0 0.0326846188541911d0 0.5628764698598764d0))
  ((rgb :best-rgb) (0.3442918958936677d0 0.2053209285876961d0 0.5824833140875284d0))
  ((rgb :beta-rgb) (0.3437458900420179d0 0.1817639421067817d0 0.5921762368476021d0))
  ((rgb :bruce-rgb) (0.3621528580898205d0 0.1248716048844887d0 0.6041607882906272d0))
  ((rgb :bt2020) (0.2794243979244552d0 0.0968985209940105d0 0.5511016463498013d0))
  ((rgb :bt470-ntsc) (0.3442742950551053d0 -0.1274549902570533d0 0.5987498237265687d0))
  ((rgb :bt470-pal/secam) (0.4623359446871282d0 0.1950197593817534d0 0.6862608538909336d0))
  ((rgb :bt709) (0.3241858562652431d0 0.0462841869717615d0 0.5813368765032577d0))
  ((rgb :colormatch-rgb) (0.2991712591752493d0 -0.0105144733431908d0 0.5628090660084785d0))
  ((rgb :dci-p3) (0.4223642854578956d0 0.2003102013857439d0 0.6428132850836858d0))
  ((rgb :dci-p3+) (0.4340570623503643d0 0.3507110290634651d0 0.6298512534151433d0))
  ((rgb :don-rgb-4) (0.3445289863398584d0 0.1901683011220877d0 0.5859118284681183d0))
  ((rgb :eci-rgb-v2) (0.3673624232501159d0 -0.0099886569641374d0 0.6403623815455688d0))
  ((rgb :ekta-space-ps5) (0.3674144935729802d0 0.2140691241737967d0 0.5921233612560919d0))
  ((rgb :prophoto-rgb) (0.3011682204852787d0 0.1438189078108793d0 0.5135821755197187d0))
  ((rgb :simple-srgb) (0.3813703461918966d0 0.1248716048844887d0 0.6160593379749467d0))
  ((rgb :smpte-c-rgb) (0.3868654765289747d0 0.0661553129423351d0 0.6145602896034925d0))
  ((rgb :srgb) (0.3810006505385893d0 0.1016790195767004d0 0.6217160220655478d0)))

(diag "~&From RGB (CIE RGB) (round trip)")
(define-tests/round-trip (rgb :cie-rgb)
  xyz
  xyy
  lab
  lch-ab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From RGB (ColorMatch RGB) (one way)")
(define-tests/one-way (rgb 0.8633025735134483d0 0.030974212758084096d0 0.9681275304682193d0
                           :space :colormatch-rgb)
  (xyz (0.5179242219875918d0 0.2754318573941936d0 0.6717742601938942d0))
  (xyy (0.3535004415631645d0 0.187991368381575d0 0.2754318573941936d0))
  (lab (59.473770370696954d0 81.1265086151769d0 -56.61972287275818d0))
  (lch-ab (59.473770370696954d0 98.93080116059056d0 325.0880841065256d0))
  (luv (59.473770370696954d0 78.61939020823655d0 -89.79003203581168d0))
  (lch-uv (59.473770370696954d0 119.3451229406005d0 311.20511462915954d0))
  ((rgb :adobe-rgb) (0.8040169291723318d0 0.2399206637105419d0 0.9446018189322941d0))
  ((rgb :adobe-wide-gamut-rgb) (0.7447100572185518d0 0.4512471401228549d0 0.931966964821864d0))
  ((rgb :apple-rgb) (0.8745900591911935d0 0.0765405772452165d0 0.9698335211671977d0))
  ((rgb :best-rgb) (0.796337217725867d0 0.4192242459706138d0 0.9146848729184889d0))
  ((rgb :beta-rgb) (0.7899565660272626d0 0.3522816134384791d0 0.9293348975574234d0))
  ((rgb :bruce-rgb) (0.8793375472640071d0 0.2400423117368665d0 0.9437167486722278d0))
  ((rgb :bt2020) (0.7652298050851766d0 0.3061449975688865d0 0.9170996019380286d0))
  ((rgb :bt470-ntsc) (0.803775633697953d0 -0.0736718049209771d0 0.9399794206148752d0))
  ((rgb :bt470-pal/secam) (0.9292642882519715d0 0.3258991831306189d0 0.97391382844151d0))
  ((rgb :bt709) (0.9215579498868927d0 0.168597847058802d0 0.9586047455449707d0))
  ((rgb :cie-rgb) (0.822207015870298d0 0.4761105058966368d0 0.9171084354471334d0))
  ((rgb :dci-p3) (0.8927965067648573d0 0.3679402290924303d0 0.9414768594770978d0))
  ((rgb :dci-p3+) (0.8544112097777012d0 0.5688720978139488d0 0.9244215754630055d0))
  ((rgb :don-rgb-4) (0.796947691694699d0 0.3728503199680194d0 0.9191501969177649d0))
  ((rgb :eci-rgb-v2) (0.8214925508020504d0 0.1604408148441601d0 0.9537609231949752d0))
  ((rgb :ekta-space-ps5) (0.834893041740463d0 0.3972726465657865d0 0.9291396783513114d0))
  ((rgb :prophoto-rgb) (0.7475848686663634d0 0.3448363843968106d0 0.8920154851706483d0))
  ((rgb :simple-srgb) (0.927929814683202d0 0.2400423117368665d0 0.9619605702798456d0))
  ((rgb :smpte-c-rgb) (0.9494575064361758d0 0.1383004157368292d0 0.9600652941296878d0))
  ((rgb :srgb) (0.9300871664423989d0 0.2302219492046465d0 0.9631535773320546d0)))

(diag "~&From RGB (ColorMatch RGB) (round trip)")
(define-tests/round-trip (rgb :colormatch-rgb)
  xyz
  xyy
  lab
  lch-ab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From RGB (DCI-P3) (one way)")
(define-tests/one-way (rgb 0.3343364449670896d0 0.21243237761458134d0 0.7448188737151806d0
                           :space :dci-p3)
  (xyz (0.1108132469271326d0 0.0570256277888072d0 0.4226408417840917d0))
  (xyy (0.1876664749535503d0 0.0965750832675793d0 0.0570256277888072d0))
  (lab (28.64930271368003d0 56.79106774267234d0 -75.46160066764259d0))
  (lch-ab (28.64930271368003d0 94.4440498426214d0 306.9644727990042d0))
  (luv (28.64930271368003d0 2.8439906896819864d0 -93.13842354541227d0))
  (lch-uv (28.64930271368003d0 93.18183419297779d0 271.7489886728941d0))
  ((rgb :adobe-rgb) (0.254258064083508d0 0.1451027320565161d0 0.7210076176345281d0))
  ((rgb :adobe-wide-gamut-rgb) (0.2432075203479124d0 0.2545764993956912d0 0.7079115238413338d0))
  ((rgb :apple-rgb) (0.1987396932008334d0 0.0522787313746497d0 0.6980499509755197d0))
  ((rgb :best-rgb) (0.2917387269698922d0 0.2131935609664875d0 0.6932249722529652d0))
  ((rgb :beta-rgb) (0.2949782284619477d0 0.1995002857258842d0 0.7048644145215893d0))
  ((rgb :bruce-rgb) (0.2727515065691615d0 0.1452022312587603d0 0.7203868620918881d0))
  ((rgb :bt2020) (0.2250652506404857d0 0.1034608637951765d0 0.6733587148886868d0))
  ((rgb :bt470-ntsc) (0.2861858689093127d0 -0.1633797626603252d0 0.7125432004527346d0))
  ((rgb :bt470-pal/secam) (0.3683944706410143d0 0.2195585945877054d0 0.7880293776226105d0))
  ((rgb :bt709) (0.2179789562930878d0 0.06449911443054d0 0.7108177962017479d0))
  ((rgb :cie-rgb) (0.1713547229369506d0 0.2829072480658749d0 0.6949530749413166d0))
  ((rgb :colormatch-rgb) (0.2253860756265999d0 0.0294325208383166d0 0.6984176349919828d0))
  ((rgb :dci-p3+) (0.3985827120308926d0 0.3903209815386308d0 0.7292761148115202d0))
  ((rgb :don-rgb-4) (0.2918861598836001d0 0.2059908302133705d0 0.697559690997963d0))
  ((rgb :eci-rgb-v2) (0.3012289745598434d0 -0.0372760912659253d0 0.7493753755628632d0))
  ((rgb :ekta-space-ps5) (0.3211232713632386d0 0.2392607654094135d0 0.7048359671159766d0))
  ((rgb :prophoto-rgb) (0.2925841545283577d0 0.1503398287611913d0 0.6352213160829835d0))
  ((rgb :simple-srgb) (0.28482527403937d0 0.1452022312587603d0 0.7345986488857439d0))
  ((rgb :smpte-c-rgb) (0.2812493556022043d0 0.0910111965944367d0 0.7326864425586908d0))
  ((rgb :srgb) (0.2786435805189999d0 0.1249124877480565d0 0.7401793153586214d0)))

(diag "~&From RGB (DCI-P3) (round trip)")
(define-tests/round-trip (rgb :dci-p3)
  xyz
  xyy
  lab
  lch-ab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From RGB (DCI-P3+) (one way)")
(define-tests/one-way (rgb 0.39623724394559123d0 0.9793750802966754d0 0.678987137100483d0
                           :space :dci-p3+)
  (xyz (0.3178145093507914d0 0.8227768492443981d0 0.3508813813128223d0))
  (xyy (0.2130877091125332d0 0.5516539640510921d0 0.8227768492443981d0))
  (lab (92.69728009863047d0 -114.40008931981494d0 44.13394823172185d0))
  (lch-ab (92.69728009863047d0 122.61804852019927d0 158.9040858097732d0))
  (luv (92.69728009863047d0 -118.162496581851d0 72.58514750516527d0))
  (lch-uv (92.69728009863047d0 138.6758062417614d0 148.438324086885d0))
  ((rgb :adobe-rgb) (0.3673960146645784d0 1.087089962932237d0 0.5866566386151226d0))
  ((rgb :adobe-wide-gamut-rgb) (0.5736098794756507d0 0.999622236130666d0 0.6032189268486557d0))
  ((rgb :apple-rgb) (-0.4238511734975725d0 1.1334522362440158d0 0.4545275013465152d0))
  ((rgb :best-rgb) (0.4411371933072256d0 1.0111809213613419d0 0.6308779923134931d0))
  ((rgb :beta-rgb) (0.4690968308929514d0 1.0490070426726321d0 0.6059701085203224d0))
  ((rgb :bruce-rgb) (-0.4152468095055572d0 1.0870577273450066d0 0.588466477992138d0))
  ((rgb :bt2020) (0.4385632195591169d0 1.0413803772269121d0 0.5802969508087334d0))
  ((rgb :bt470-ntsc) (0.4033536268545796d0 1.102723115218363d0 0.5851389835430935d0))
  ((rgb :bt470-pal/secam) (-0.6178460283070033d0 1.0677859243689967d0 0.61815931809056d0))
  ((rgb :bt709) (-1.4582577251760382d0 1.0946796057226709d0 0.5118811373263806d0))
  ((rgb :cie-rgb) (0.0471612907751094d0 0.9895712485756739d0 0.6265004297974374d0))
  ((rgb :colormatch-rgb) (-0.3538456474376659d0 1.138696331801959d0 0.4615791286690968d0))
  ((rgb :dci-p3) (-0.4506185546795048d0 1.0536366181585195d0 0.650786463451676d0))
  ((rgb :don-rgb-4) (0.438802270524933d0 1.0389718310463822d0 0.6249466186876723d0))
  ((rgb :eci-rgb-v2) (0.469100338866706d0 1.0779430263328673d0 0.6121457571961603d0))
  ((rgb :ekta-space-ps5) (0.2752660297172281d0 1.0328061440598046d0 0.6065640670956459d0))
  ((rgb :prophoto-rgb) (0.476442777198254d0 1.0139898196870596d0 0.5761136004256344d0))
  ((rgb :simple-srgb) (-0.5991772990139977d0 1.0870577273450066d0 0.552564336538627d0))
  ((rgb :smpte-c-rgb) (-0.6701270959502273d0 1.105584618105059d0 0.5554585220725585d0))
  ((rgb :srgb) (-4.186819957616537d0 1.0838958660796367d0 0.5574962114078488d0)))

(diag "~&From RGB (DCI-P3+) (round trip)")
(define-tests/round-trip (rgb :dci-p3+)
  xyz
  xyy
  lab
  lch-ab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From RGB (Don RGB 4) (one way)")
(define-tests/one-way (rgb 0.903261068392325d0 0.8406642841997971d0 0.10535425813413157d0
                           :space :don-rgb-4)
  (xyz (0.6491232576965265d0 0.6923764072250577d0 0.0209305961534372d0))
  (xyy (0.4764451262146348d0 0.50819218201946d0 0.6923764072250577d0))
  (lab (86.62159084835201d0 -4.118456894920075d0 118.17047712295827d0))
  (lch-ab (86.62159084835201d0 118.24222321431088d0 91.99605462476352d0))
  (luv (86.62159084835201d0 27.938681617239677d0 82.69297767523773d0))
  (lch-uv (86.62159084835201d0 87.2851561681988d0 71.33192600384052d0))
  ((rgb :adobe-rgb) (0.9257853007057055d0 0.8458795851648524d0 -0.257364452843717d0))
  ((rgb :adobe-wide-gamut-rgb) (0.9116094556359502d0 0.8304225981578973d0 -0.1565158370499335d0))
  ((rgb :apple-rgb) (0.9424951604593172d0 0.8202707570734008d0 -0.2907373437199317d0))
  ((rgb :best-rgb) (0.9031365730865428d0 0.8451065451176234d0 0.15942915451657d0))
  ((rgb :beta-rgb) (0.8990076970670473d0 0.8403380900812519d0 -0.1157494414658101d0))
  ((rgb :bruce-rgb) (0.9433349617314042d0 0.8459298643069504d0 -0.2536483095342282d0))
  ((rgb :bt2020) (0.8904245772911972d0 0.8357888786217098d0 0.0086736975195364d0))
  ((rgb :bt470-ntsc) (0.9089350021864326d0 0.8766401399532792d0 -0.1888403815114717d0))
  ((rgb :bt470-pal/secam) (0.961380701788426d0 0.8768101457798301d0 -0.4259627904864226d0))
  ((rgb :bt709) (0.9514912513487563d0 0.8322337474472693d0 -0.3709277714222652d0))
  ((rgb :cie-rgb) (0.9636822495959467d0 0.8186736998550282d0 0.1433382691467082d0))
  ((rgb :colormatch-rgb) (0.9195543986927629d0 0.8229322629883346d0 -0.294212806519671d0))
  ((rgb :dci-p3) (0.9498081316318446d0 0.8701626369786567d0 -0.1755058150981344d0))
  ((rgb :dci-p3+) (0.9023931406397894d0 0.8228045266509999d0 0.2591244166995796d0))
  ((rgb :eci-rgb-v2) (0.9202068115877068d0 0.8822213995922145d0 -0.3372038559438881d0))
  ((rgb :ekta-space-ps5) (0.8984979864449134d0 0.8289802545606846d0 -0.1161372216586165d0))
  ((rgb :prophoto-rgb) (0.8174045325485841d0 0.8144570669349207d0 0.1298554866662557d0))
  ((rgb :simple-srgb) (0.9554252499244476d0 0.8459298643069505d0 -0.3215937892903607d0))
  ((rgb :smpte-c-rgb) (0.9657383586085594d0 0.8507931128837547d0 -0.312522147150849d0))
  ((rgb :srgb) (0.9568111198744725d0 0.8499868885884625d0 -1.0649748459501482d0)))

(diag "~&From RGB (Don RGB 4) (round trip)")
(define-tests/round-trip (rgb :don-rgb-4)
  xyz
  xyy
  lab
  lch-ab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From RGB (ECI RGB v2) (one way)")
(define-tests/one-way (rgb 0.4757157961828884d0 0.5382394522451406d0 0.8456712379120774d0
                           :space :eci-rgb-v2)
  (xyz (0.2344341010019042d0 0.2346344082677029d0 0.5082984979049704d0))
  (xyy (0.2398629166740734d0 0.2400678624767538d0 0.2346344082677029d0))
  (lab (55.5465267993102d0 3.6803258639943603d0 -46.814803026877485d0))
  (lch-ab (55.5465267993102d0 46.95924382813807d0 274.49503843677337d0))
  (luv (55.5465267993102d0 -22.7598212930054d0 -63.57617195445309d0))
  (lch-uv (55.5465267993102d0 67.52732117944358d0 250.3029907003886d0))
  ((rgb :adobe-rgb) (0.4133686793871365d0 0.5197668495727334d0 0.8274440077998565d0))
  ((rgb :adobe-wide-gamut-rgb) (0.4353363389020815d0 0.5341271997207917d0 0.8163805824428785d0))
  ((rgb :apple-rgb) (0.2931293542165513d0 0.4450028752682342d0 0.8150940286724576d0))
  ((rgb :best-rgb) (0.4461843296659539d0 0.5197068946051165d0 0.8049332243680224d0))
  ((rgb :beta-rgb) (0.4518320730403082d0 0.5250779722012682d0 0.8136998922252799d0))
  ((rgb :bruce-rgb) (0.3833998408413509d0 0.5198876457088907d0 0.8269663911430682d0))
  ((rgb :bt2020) (0.401157066399239d0 0.4716489426020151d0 0.7932492743499425d0))
  ((rgb :bt470-ntsc) (0.4380814106107951d0 0.4864328359769542d0 0.8192377489724546d0))
  ((rgb :bt470-pal/secam) (0.4567455107784913d0 0.5981168446718508d0 0.8725584080504506d0))
  ((rgb :bt709) (0.3011574258570772d0 0.476106259741168d0 0.8233344947549254d0))
  ((rgb :cie-rgb) (0.3476968524571325d0 0.5454180120118438d0 0.8061601278802932d0))
  ((rgb :colormatch-rgb) (0.3255034777218868d0 0.442560684677081d0 0.8160006462468286d0))
  ((rgb :dci-p3) (0.448402449537576d0 0.5721905807627267d0 0.8405330028609383d0))
  ((rgb :dci-p3+) (0.5261129417523157d0 0.6189974980685172d0 0.8286137895682472d0))
  ((rgb :don-rgb-4) (0.4460038524724222d0 0.5246137413511469d0 0.8084718190214509d0))
  ((rgb :ekta-space-ps5) (0.4516012808740412d0 0.536123229858147d0 0.8137238684197389d0))
  ((rgb :prophoto-rgb) (0.4415362681240105d0 0.4490177468969475d0 0.7639977816574187d0))
  ((rgb :simple-srgb) (0.3604136247012826d0 0.5198876457088907d0 0.8377645488622609d0))
  ((rgb :smpte-c-rgb) (0.3396335774249186d0 0.5150888594322199d0 0.8361459982461842d0))
  ((rgb :srgb) (0.3589871806779134d0 0.5242101522293497d0 0.8419762418535232d0)))

(diag "~&From RGB (ECI RGB v2) (round trip)")
(define-tests/round-trip (rgb :eci-rgb-v2)
  xyz
  xyy
  lab
  lch-ab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From RGB (Ekta Space PS 5) (one way)")
(define-tests/one-way (rgb 0.09574184262171914d0 0.8854733764856817d0 0.8354879062437013d0
                           :space :ekta-space-ps5)
  (xyz (0.2778475987785322d0 0.5668716729513777d0 0.5595321876489582d0))
  (xyy (0.1978617126746163d0 0.4036824524306478d0 0.5668716729513777d0))
  (lab (80.00331755111789d0 -83.55343638626772d0 -10.183340124011032d0))
  (lch-ab (80.00331755111789d0 84.17171227933633d0 186.9488334723535d0))
  (luv (80.00331755111789d0 -107.02334170545666d0 -0.3170151632470488d0))
  (lch-uv (80.00331755111789d0 107.0238112216934d0 180.1697160402891d0))
  ((rgb :adobe-rgb) (0.1121298428636412d0 0.9202557371234645d0 0.8407894292118718d0))
  ((rgb :adobe-wide-gamut-rgb) (0.4204480925600725d0 0.8577743177037613d0 0.8367422141899158d0))
  ((rgb :apple-rgb) (-0.4552978073470462d0 0.9211775211592497d0 0.80212221476949d0))
  ((rgb :best-rgb) (0.3023212089284199d0 0.858611819351423d0 0.8378759802731597d0))
  ((rgb :beta-rgb) (0.3395039209702375d0 0.8922555840163933d0 0.8351943696366585d0))
  ((rgb :bruce-rgb) (-0.4641871550852303d0 0.9202828954188496d0 0.8410270398553246d0))
  ((rgb :bt2020) (0.2953475865179349d0 0.8674146488409537d0 0.8211714837094943d0))
  ((rgb :bt470-ntsc) (0.2448586950090109d0 0.9160751211601972d0 0.831609293436054d0))
  ((rgb :bt470-pal/secam) (-0.6279790182603188d0 0.9368120955539332d0 0.8688557598415981d0))
  ((rgb :bt709) (-1.4420559477974955d0 0.9132314556665984d0 0.8227478775082206d0))
  ((rgb :cie-rgb) (-0.3703034811294188d0 0.8565663876125558d0 0.8370413917894806d0))
  ((rgb :colormatch-rgb) (-0.3848527242254483d0 0.92387121324802d0 0.806078264632076d0))
  ((rgb :dci-p3) (-0.5049913754607998d0 0.9144617461288013d0 0.8576769301754718d0))
  ((rgb :dci-p3+) (0.2948572077980861d0 0.8796317993650482d0 0.8581743430841041d0))
  ((rgb :don-rgb-4) (0.2995655393048d0 0.8838854988808497d0 0.8386368571158893d0))
  ((rgb :eci-rgb-v2) (0.3017908995159806d0 0.9266988386771046d0 0.8525890279805824d0))
  ((rgb :prophoto-rgb) (0.4095002141180832d0 0.830033710742952d0 0.8058648915205262d0))
  ((rgb :simple-srgb) (-0.5961421321427541d0 0.9202828954188497d0 0.8372263388599066d0))
  ((rgb :smpte-c-rgb) (-0.6550698699344945d0 0.9328657302988546d0 0.8366991936381368d0))
  ((rgb :srgb) (-4.140302854565253d0 0.9226431552204883d0 0.8414479988021314d0)))

(diag "~&From RGB (Ekta Space PS 5) (round trip)")
(define-tests/round-trip (rgb :ekta-space-ps5)
  xyz
  xyy
  lab
  lch-ab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From RGB (ProPhoto RGB) (one way)")
(define-tests/one-way (rgb 0.9661050361445147d0 0.6029093842410664d0 0.40219699921506d0
                           :space :prophoto-rgb)
  (xyz (0.8101229374759039d0 0.5570439891980326d0 0.1601558982278273d0))
  (xyy (0.5304202387782756d0 0.3647192198766893d0 0.5570439891980326d0))
  (lab (79.44528666338432d0 60.40318922786081d0 48.76491008541643d0))
  (lch-ab (79.44528666338432d0 77.63093278156272d0 38.91475056206659d0))
  (luv (79.44528666338432d0 130.93037997252844d0 32.68725788481887d0))
  (lch-uv (79.44528666338432d0 134.94895786103476d0 14.017569248730414d0))
  ((rgb :adobe-rgb) (1.084417203283795d0 0.5603868057016215d0 0.4357276389476412d0))
  ((rgb :adobe-wide-gamut-rgb) (1.0172032691772268d0 0.6546628380856466d0 0.45952700105107d0))
  ((rgb :apple-rgb) (1.241736061995703d0 0.4648859685082677d0 0.3491710965395265d0))
  ((rgb :best-rgb) (1.0494533519341873d0 0.6608744116196866d0 0.4719287043689514d0))
  ((rgb :beta-rgb) (1.0387701883537794d0 0.606769621378102d0 0.4665304750838632d0))
  ((rgb :bruce-rgb) (1.1687314878662833d0 0.5605020646039182d0 0.4361801263171963d0))
  ((rgb :bt2020) (1.03752285026823d0 0.6008626904403038d0 0.4211821905143476d0))
  ((rgb :bt470-ntsc) (1.063076072976126d0 0.5867413236710008d0 0.4669361807578622d0))
  ((rgb :bt470-pal/secam) (1.1573928328332346d0 0.6345319978661919d0 0.5130317087678002d0))
  ((rgb :bt709) (1.243359648490545d0 0.5205682255072296d0 0.377042008110509d0))
  ((rgb :cie-rgb) (1.1459505857373526d0 0.6507838097552525d0 0.4721346491200243d0))
  ((rgb :colormatch-rgb) (1.2036983054680246d0 0.4615782718353925d0 0.3399257774545742d0))
  ((rgb :dci-p3) (1.1354007657800518d0 0.6479266952621838d0 0.5259788307611305d0))
  ((rgb :dci-p3+) (1.0484923516317326d0 0.6807135526449497d0 0.5407301639063891d0))
  ((rgb :don-rgb-4) (1.0501326308045487d0 0.6205282758240805d0 0.4659376053329365d0))
  ((rgb :eci-rgb-v2) (1.0462125551441765d0 0.6194537090217427d0 0.5001274585560501d0))
  ((rgb :ekta-space-ps5) (1.0771628109809435d0 0.6117421218144136d0 0.4658879384190834d0))
  ((rgb :simple-srgb) (1.223907745254498d0 0.5605020646039183d0 0.4295140350958414d0))
  ((rgb :smpte-c-rgb) (1.253758261835738d0 0.5390198404779315d0 0.4330541816859003d0))
  ((rgb :srgb) (1.214663844219434d0 0.5655568513914941d0 0.4312000949968212d0)))

(diag "~&From RGB (ProPhoto RGB) (round trip)")
(define-tests/round-trip (rgb :prophoto-rgb)
  xyz
  xyy
  lab
  lch-ab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From RGB (Simple sRGB) (one way)")
(define-tests/one-way (rgb 0.3326775911243629d0 0.07825302383771171d0 0.396211455210826d0
                           :space :simple-srgb)
  (xyz (0.0614782149106999d0 0.0309306377550514d0 0.1261300056825786d0))
  (xyy (0.2813147985458473d0 0.1415338122877488d0 0.0309306377550514d0))
  (lab (20.412817193922066d0 43.75893463334951d0 -34.712274927707156d0))
  (lch-ab (20.412817193922066d0 55.85504803419725d0 321.5763886449412d0))
  (luv (20.412817193922066d0 19.703440067714386d0 -42.54775066251186d0))
  (lch-uv (20.412817193922066d0 46.888555500690046d0 294.84838523966806d0))
  ((rgb :adobe-rgb) (0.2876542769400003d0 0.0781822304212126d0 0.3887953704162372d0))
  ((rgb :adobe-wide-gamut-rgb) (0.2663386375324392d0 0.1672358856491565d0 0.3829565680843262d0))
  ((rgb :apple-rgb) (0.2489040890233142d0 -0.0136492587536192d0 0.3281382563316814d0))
  ((rgb :best-rgb) (0.2878429789249191d0 0.1513720048149254d0 0.3756017185297374d0))
  ((rgb :beta-rgb) (0.2859174605791998d0 0.1266393840309854d0 0.3817977758591126d0))
  ((rgb :bruce-rgb) (0.3150735925273944d0 0.0782530238377109d0 0.3885458198705337d0))
  ((rgb :bt2020) (0.2167840618697741d0 0.0495042522672292d0 0.322062691202377d0))
  ((rgb :bt470-ntsc) (0.2899623816052956d0 -0.0773367493847649d0 0.3861722753796183d0))
  ((rgb :bt470-pal/secam) (0.414996503099619d0 0.1350852806828113d0 0.4851481185317266d0))
  ((rgb :bt709) (0.270658762325155d0 0.0165544591458275d0 0.3404864096240624d0))
  ((rgb :cie-rgb) (0.2896382414778719d0 0.1792049951720205d0 0.3765948086812049d0))
  ((rgb :colormatch-rgb) (0.2476248326961818d0 -0.026812589555126d0 0.3277805498532157d0))
  ((rgb :dci-p3) (0.3747529922839144d0 0.1489755232565847d0 0.4434753680825369d0))
  ((rgb :dci-p3+) (0.3643274287664766d0 0.253612879253355d0 0.4349538295091406d0))
  ((rgb :don-rgb-4) (0.288063805301829d0 0.1345719822666806d0 0.3776183219584009d0))
  ((rgb :eci-rgb-v2) (0.3046842441296443d0 -4.01239576381d-5 0.4201773110356812d0))
  ((rgb :ekta-space-ps5) (0.3033976669551046d0 0.1472971559897402d0 0.381735794336485d0))
  ((rgb :prophoto-rgb) (0.2219340420103455d0 0.0992037672046835d0 0.3004729638389997d0))
  ((rgb :smpte-c-rgb) (0.3399066025444107d0 -0.0160673326713856d0 0.3953440913240998d0))
  ((rgb :srgb) (0.3296868836439915d0 0.0470849751482451d0 0.396528916484171d0)))

(diag "~&From RGB (Simple sRGB) (round trip)")
(define-tests/round-trip (rgb :simple-srgb)
  xyz
  xyy
  lab
  lch-ab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :smpte-c-rgb)
  (rgb :srgb))

(diag "~&From RGB (SMPTE-C RGB) (one way)")
(define-tests/one-way (rgb 0.33305567309949025d0 0.3562644125718484d0 0.256029016232886d0
                           :space :smpte-c-rgb)
  (xyz (0.0823155282116541d0 0.0956155623166773d0 0.0610563915700192d0))
  (xyy (0.3444344761864088d0 0.4000860692667099d0 0.0956155623166773d0))
  (lab (37.04374562703637d0 -7.416979461526169d0 14.90488896372768d0))
  (lch-ab (37.04374562703637d0 16.64834224040797d0 116.45588273645843d0))
  (luv (37.04374562703637d0 -1.9810450557442587d0 18.27640628719308d0))
  (lch-uv (37.04374562703637d0 18.383459040328606d0 96.18634182312512d0))
  ((rgb :adobe-rgb) (0.3395674198575419d0 0.3543575638434276d0 0.260209320889864d0))
  ((rgb :adobe-wide-gamut-rgb) (0.3419087169021957d0 0.3472504236771083d0 0.2646439661858273d0))
  ((rgb :apple-rgb) (0.2636528018365561d0 0.2833236142406359d0 0.1848569334311715d0))
  ((rgb :best-rgb) (0.3373939299851995d0 0.3500806300304663d0 0.2696995348175857d0))
  ((rgb :beta-rgb) (0.3373415123933127d0 0.3515089009420719d0 0.2657862249804934d0))
  ((rgb :bruce-rgb) (0.3361248190613375d0 0.3544881375507857d0 0.260588234284764d0))
  ((rgb :bt2020) (0.2762680876909708d0 0.2920670405589125d0 0.1986987689995121d0))
  ((rgb :bt470-ntsc) (0.3375770779221015d0 0.3597732948548963d0 0.2630751518183229d0))
  ((rgb :bt470-pal/secam) (0.422970609570139d0 0.4427062229153143d0 0.3405560581744054d0))
  ((rgb :bt709) (0.2716573523411087d0 0.2946437696262263d0 0.1854719521871954d0))
  ((rgb :cie-rgb) (0.3432936903582515d0 0.3451832419031514d0 0.2691162862712328d0))
  ((rgb :colormatch-rgb) (0.2619938554975265d0 0.2838748227419169d0 0.1848313106655216d0))
  ((rgb :dci-p3) (0.3975855467431268d0 0.414816005039038d0 0.325468168691575d0))
  ((rgb :dci-p3+) (0.3940343526364764d0 0.4024317208333361d0 0.3313967476029585d0))
  ((rgb :don-rgb-4) (0.3373649819506488d0 0.3509886965614721d0 0.2683050812279183d0))
  ((rgb :eci-rgb-v2) (0.363522860229848d0 0.3854707844476029d0 0.273559037247404d0))
  ((rgb :ekta-space-ps5) (0.3339003167442552d0 0.349002659282136d0 0.2658035288439676d0))
  ((rgb :prophoto-rgb) (0.2591422505368965d0 0.2773071855043771d0 0.2025610237254209d0))
  ((rgb :simple-srgb) (0.3335853708688173d0 0.3544881375507857d0 0.2553364932696587d0))
  ((rgb :srgb) (0.3306489974039644d0 0.3527437919297797d0 0.2468370922440968d0)))

(diag "~&From RGB (SMPTE-C RGB) (round trip)")
(define-tests/round-trip (rgb :smpte-c-rgb)
  xyz
  xyy
  lab
  lch-ab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :srgb))

(diag "~&From RGB (sRGB) (one way)")
(define-tests/one-way (rgb 0.9981610052232226d0 0.3422419922805373d0 0.06520086530994451d0
                           :space :srgb)
  (xyz (0.4459474718435258d0 0.2807444148120802d0 0.0358581702754469d0))
  (xyy (0.5848107514912254d0 0.3681652270041914d0 0.2807444148120802d0))
  (lab (59.95593209930084d0 61.133911920680404d0 66.85280383185929d0))
  (lch-ab (59.95593209930084d0 90.59057658998849d0 47.55847298888456d0))
  (luv (59.95593209930084d0 137.60598472010605d0 48.29705364609488d0))
  (lch-uv (59.95593209930084d0 145.8355663810575d0 19.340092048763918d0))
  ((rgb :adobe-rgb) (0.8717543497889991d0 0.3444093308775093d0 0.1184316116889793d0))
  ((rgb :adobe-wide-gamut-rgb) (0.8100131645002422d0 0.4537889736453585d0 0.1811091099712774d0))
  ((rgb :apple-rgb) (0.9647177058206092d0 0.2395189616599386d0 0.0279509143869492d0))
  ((rgb :best-rgb) (0.8397205782729896d0 0.4606901252035971d0 0.2063969354380437d0))
  ((rgb :beta-rgb) (0.8298864999527187d0 0.4001911258422567d0 0.1955517927381878d0))
  ((rgb :bruce-rgb) (0.9484036909890003d0 0.3445397228532495d0 0.119643103478467d0))
  ((rgb :bt2020) (0.8104608627328759d0 0.3787994692551222d0 0.1266202592591848d0))
  ((rgb :bt470-ntsc) (0.8522369781592672d0 0.3770649323076106d0 0.1961239723747482d0))
  ((rgb :bt470-pal/secam) (0.9847406128840763d0 0.4329146743376622d0 0.1435906117801108d0))
  ((rgb :bt709) (0.9979311967699724d0 0.2837054081651345d0 0.0245010578938107d0))
  ((rgb :cie-rgb) (0.9279084480171267d0 0.4494645871343018d0 0.20673865426919d0))
  ((rgb :colormatch-rgb) (0.931878581620549d0 0.235586291827016d0 -0.0424943174287708d0))
  ((rgb :dci-p3) (0.9509073785295135d0 0.451733401771603d0 0.254465974139421d0))
  ((rgb :dci-p3+) (0.8689809385058759d0 0.4910703868540671d0 0.2857737667142188d0))
  ((rgb :don-rgb-4) (0.8403445958014031d0 0.415961682397081d0 0.1945889598167209d0))
  ((rgb :eci-rgb-v2) (0.8648416724416722d0 0.400191705235814d0 0.1821369790069728d0))
  ((rgb :ekta-space-ps5) (0.8650745630807135d0 0.4058077504068956d0 0.1942657040881554d0))
  ((rgb :prophoto-rgb) (0.7242569638286198d0 0.3879536784250615d0 0.1498108251329043d0))
  ((rgb :simple-srgb) (0.9980985620085232d0 0.3445397228532495d0 0.0935182799364484d0))
  ((rgb :smpte-c-rgb) (1.0248819354417928d0 0.3168383051968562d0 0.107914166376972d0)))

(diag "~&From RGB (sRGB) (round trip)")
(define-tests/round-trip (rgb :srgb)
  xyz
  xyy
  lab
  lch-ab
  luv
  lch-uv
  (rgb :adobe-rgb)
  (rgb :adobe-wide-gamut-rgb)
  (rgb :apple-rgb)
  (rgb :best-rgb)
  (rgb :beta-rgb)
  (rgb :bruce-rgb)
  (rgb :bt2020)
  (rgb :bt470-ntsc)
  (rgb :bt470-pal/secam)
  (rgb :bt709)
  (rgb :cie-rgb)
  (rgb :colormatch-rgb)
  (rgb :dci-p3)
  (rgb :dci-p3+)
  (rgb :don-rgb-4)
  (rgb :eci-rgb-v2)
  (rgb :ekta-space-ps5)
  (rgb :prophoto-rgb)
  (rgb :simple-srgb)
  (rgb :smpte-c-rgb))

(finalize)
